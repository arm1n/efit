/*!
 * eFit Website
 * An app for financial training in educational environments
 * http://www.e-fit.com
 * @author Armin Pfurtscheller
 * @version 1.0.0
 * Copyright 2017. MIT licensed.
 */
/* global ANGULAR_MODULE, angular */
(function(module, angular) {
  'use strict';

 /**
  * @constructor
  */
  var LoginBackend = function($scope, $injector) {
    this.$injector = $injector;
    this.$scope = $scope;
  };

  LoginBackend.$inject = ['$scope', '$injector'];

  //
  // PROPERTIES
  //

  /** @var {string} username Username for authentication. */
  LoginBackend.prototype.username = 'admin';

  /** @var {string} workshop Password for authentication. */
  LoginBackend.prototype.password = 'test';

  /** @var {RegExp} usernameMinLength Minimum length of username. */
  LoginBackend.prototype.usernameMinLength = 5;

  /** @var {RegExp} passwordMinLength Minimum length of password. */
  LoginBackend.prototype.passwordMinLength = 4;

  /** @var {RegExp} passwordMaxLength Maximum length of password. */
  LoginBackend.prototype.passwordMaxLength = 4096;

  //
  // METHODS
  //

  /**
   * Signs an admin in with username and password.
   *
   * @public
   * @method signin
   * @return {Void}
   */
  LoginBackend.prototype.signin = function()
    {
      var notification = this.$injector.get('notification');
      var $state = this.$injector.get('$state');
      var auth = this.$injector.get('auth');
      var i18n = this.$injector.get('i18n');

      var form = this.$scope.loginForm;
      if (form.$invalid) {
        return;
      }

      var successCallback = function()
      {
        var message = i18n.get('You are logged in now!');
        notification.success(message);
        $state.go('backend');
      };

      var failureCallback = function()
      {
        // @see: httpInterceptor
      };

      auth.signin({
        username: this.username,
        password: this.password
      }, 'backend').then(
        successCallback,
        failureCallback
      );
    };

  angular.module(module).controller('LoginBackendController', LoginBackend);

})(ANGULAR_MODULE, angular);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9jb250cm9sbGVycy9sb2dpbi9iYWNrZW5kLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImFwcC9jb250cm9sbGVycy9sb2dpbi9iYWNrZW5kLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBBTkdVTEFSX01PRFVMRSwgYW5ndWxhciAqL1xuKGZ1bmN0aW9uKG1vZHVsZSwgYW5ndWxhcikge1xuICAndXNlIHN0cmljdCc7XG5cbiAvKipcbiAgKiBAY29uc3RydWN0b3JcbiAgKi9cbiAgdmFyIExvZ2luQmFja2VuZCA9IGZ1bmN0aW9uKCRzY29wZSwgJGluamVjdG9yKSB7XG4gICAgdGhpcy4kaW5qZWN0b3IgPSAkaW5qZWN0b3I7XG4gICAgdGhpcy4kc2NvcGUgPSAkc2NvcGU7XG4gIH07XG5cbiAgTG9naW5CYWNrZW5kLiRpbmplY3QgPSBbJyRzY29wZScsICckaW5qZWN0b3InXTtcblxuICAvL1xuICAvLyBQUk9QRVJUSUVTXG4gIC8vXG5cbiAgLyoqIEB2YXIge3N0cmluZ30gdXNlcm5hbWUgVXNlcm5hbWUgZm9yIGF1dGhlbnRpY2F0aW9uLiAqL1xuICBMb2dpbkJhY2tlbmQucHJvdG90eXBlLnVzZXJuYW1lID0gJ2FkbWluJztcblxuICAvKiogQHZhciB7c3RyaW5nfSB3b3Jrc2hvcCBQYXNzd29yZCBmb3IgYXV0aGVudGljYXRpb24uICovXG4gIExvZ2luQmFja2VuZC5wcm90b3R5cGUucGFzc3dvcmQgPSAndGVzdCc7XG5cbiAgLyoqIEB2YXIge1JlZ0V4cH0gdXNlcm5hbWVNaW5MZW5ndGggTWluaW11bSBsZW5ndGggb2YgdXNlcm5hbWUuICovXG4gIExvZ2luQmFja2VuZC5wcm90b3R5cGUudXNlcm5hbWVNaW5MZW5ndGggPSA1O1xuXG4gIC8qKiBAdmFyIHtSZWdFeHB9IHBhc3N3b3JkTWluTGVuZ3RoIE1pbmltdW0gbGVuZ3RoIG9mIHBhc3N3b3JkLiAqL1xuICBMb2dpbkJhY2tlbmQucHJvdG90eXBlLnBhc3N3b3JkTWluTGVuZ3RoID0gNDtcblxuICAvKiogQHZhciB7UmVnRXhwfSBwYXNzd29yZE1heExlbmd0aCBNYXhpbXVtIGxlbmd0aCBvZiBwYXNzd29yZC4gKi9cbiAgTG9naW5CYWNrZW5kLnByb3RvdHlwZS5wYXNzd29yZE1heExlbmd0aCA9IDQwOTY7XG5cbiAgLy9cbiAgLy8gTUVUSE9EU1xuICAvL1xuXG4gIC8qKlxuICAgKiBTaWducyBhbiBhZG1pbiBpbiB3aXRoIHVzZXJuYW1lIGFuZCBwYXNzd29yZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIHNpZ25pblxuICAgKiBAcmV0dXJuIHtWb2lkfVxuICAgKi9cbiAgTG9naW5CYWNrZW5kLnByb3RvdHlwZS5zaWduaW4gPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IHRoaXMuJGluamVjdG9yLmdldCgnbm90aWZpY2F0aW9uJyk7XG4gICAgICB2YXIgJHN0YXRlID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCckc3RhdGUnKTtcbiAgICAgIHZhciBhdXRoID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCdhdXRoJyk7XG4gICAgICB2YXIgaTE4biA9IHRoaXMuJGluamVjdG9yLmdldCgnaTE4bicpO1xuXG4gICAgICB2YXIgZm9ybSA9IHRoaXMuJHNjb3BlLmxvZ2luRm9ybTtcbiAgICAgIGlmIChmb3JtLiRpbnZhbGlkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHN1Y2Nlc3NDYWxsYmFjayA9IGZ1bmN0aW9uKClcbiAgICAgIHtcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSBpMThuLmdldCgnWW91IGFyZSBsb2dnZWQgaW4gbm93IScpO1xuICAgICAgICBub3RpZmljYXRpb24uc3VjY2VzcyhtZXNzYWdlKTtcbiAgICAgICAgJHN0YXRlLmdvKCdiYWNrZW5kJyk7XG4gICAgICB9O1xuXG4gICAgICB2YXIgZmFpbHVyZUNhbGxiYWNrID0gZnVuY3Rpb24oKVxuICAgICAge1xuICAgICAgICAvLyBAc2VlOiBodHRwSW50ZXJjZXB0b3JcbiAgICAgIH07XG5cbiAgICAgIGF1dGguc2lnbmluKHtcbiAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUsXG4gICAgICAgIHBhc3N3b3JkOiB0aGlzLnBhc3N3b3JkXG4gICAgICB9LCAnYmFja2VuZCcpLnRoZW4oXG4gICAgICAgIHN1Y2Nlc3NDYWxsYmFjayxcbiAgICAgICAgZmFpbHVyZUNhbGxiYWNrXG4gICAgICApO1xuICAgIH07XG5cbiAgYW5ndWxhci5tb2R1bGUobW9kdWxlKS5jb250cm9sbGVyKCdMb2dpbkJhY2tlbmRDb250cm9sbGVyJywgTG9naW5CYWNrZW5kKTtcblxufSkoQU5HVUxBUl9NT0RVTEUsIGFuZ3VsYXIpO1xuIl19
