/*!
 * eFit Website
 * An app for financial training in educational environments
 * http://www.e-fit.com
 * @author Armin Pfurtscheller
 * @version 1.0.0
 * Copyright 2017. MIT licensed.
 */
!function(t,e){"use strict";var r=function(t){this.$injector=t,this._urls={}};r.$inject=["$injector"],r.prototype.getLastSuccessResponse=function(){return this._lastSuccessResponse},r.prototype.getLastErrorResponse=function(){return this._lastErrorResponse},r.prototype.getLastResponse=function(){return this._lastResponse},r.prototype.getUrls=function(){return this._urls},r.prototype.request=function(t){var e=this.$injector.get("appState");e.httpBusy=!0,this._setUrl(t),t.headers["X-Requested-With"]="XMLHttpRequest";var r=function(e){return e&&(t.headers.Authorization="Bearer "+e),t},s=function(){return t};if(t.skipAuthorization)return t;var n=this._getJWTToken(t),o=this.$injector.get("$q");return o.when(n).then(r,s)},r.prototype.requestError=function(t){var e=this.$injector.get("appState"),r=this.$injector.get("$q");return e.httpBusy=!1,r.reject(t)},r.prototype.response=function(t){var e=this.$injector.get("appState");return this._setLastSuccessResponse(t),this._setLastResponse(t),e.httpBusy=!1,t},r.prototype.responseError=function(t){var e=this.$injector.get("appState"),r=this.$injector.get("$q");return this._showGlobalErrorMessage(t),this._setLastErrorResponse(t),this._setLastResponse(t),e.httpBusy=!1,r.reject(t)},r.prototype._setUrl=function(t){var e=this.$injector.get("$httpParamSerializer"),r=e(t.params),s=t.url+(r?"?"+r:"");this._urls[s]=!0},r.prototype._setLastResponse=function(t){this._lastResponse=t},r.prototype._setLastErrorResponse=function(t){this._lastErrorResponse=t},r.prototype._setLastSuccessResponse=function(t){this._lastSuccessResponse=t},r.prototype._showGlobalErrorMessage=function(t){var e=this.$injector.get("notification"),r=this.$injector.get("i18n"),s=t.config||{};if(!s.skipGlobalErrorMessage){var n=t.data||{};n.message&&e.error(r.get(n.message))}},r.prototype._getJWTToken=function(){var t=this.$injector.get("auth"),e=this.$injector.get("jwt"),r=e.getToken();if(!r)return null;if(e.isExpired(r,600)){var s=function(){return e.getToken()},n=function(){return null};return t.refresh().then(s,n)}return e.getToken()},e.module(t).factory("httpInterceptor",["$injector",function(t){var e=t.instantiate(r);return{getUrls:function(){return e.getUrls()},getLastResponse:function(){return e.getLastResponse()},getLastErrorResponse:function(){return e.getLastErrorResponse()},getLastSuccessResponse:function(){return e.getLastSuccessResponse()},request:function(t){return e.request(t)},response:function(t){return e.response(t)},requestError:function(t){return e.responseError(t)},responseError:function(t){return e.responseError(t)}}}])}(ANGULAR_MODULE,angular);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zZXJ2aWNlcy9odHRwLWludGVyY2VwdG9yLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImFuZ3VsYXIiLCJIdHRwSW50ZXJjZXB0b3IiLCIkaW5qZWN0b3IiLCJ0aGlzIiwiX3VybHMiLCIkaW5qZWN0IiwicHJvdG90eXBlIiwiZ2V0TGFzdFN1Y2Nlc3NSZXNwb25zZSIsIl9sYXN0U3VjY2Vzc1Jlc3BvbnNlIiwiZ2V0TGFzdEVycm9yUmVzcG9uc2UiLCJfbGFzdEVycm9yUmVzcG9uc2UiLCJnZXRMYXN0UmVzcG9uc2UiLCJfbGFzdFJlc3BvbnNlIiwiZ2V0VXJscyIsInJlcXVlc3QiLCJjb25maWciLCJhcHBTdGF0ZSIsImdldCIsImh0dHBCdXN5IiwiX3NldFVybCIsImhlYWRlcnMiLCJzdWNjZXNzQ2FsbGJhY2siLCJ0b2tlbiIsIkF1dGhvcml6YXRpb24iLCJmYWlsdXJlQ2FsbGJhY2siLCJza2lwQXV0aG9yaXphdGlvbiIsImp3dFRva2VuIiwiX2dldEpXVFRva2VuIiwiJHEiLCJ3aGVuIiwidGhlbiIsInJlcXVlc3RFcnJvciIsInJlamVjdGlvbiIsInJlamVjdCIsInJlc3BvbnNlIiwiX3NldExhc3RTdWNjZXNzUmVzcG9uc2UiLCJfc2V0TGFzdFJlc3BvbnNlIiwicmVzcG9uc2VFcnJvciIsIl9zaG93R2xvYmFsRXJyb3JNZXNzYWdlIiwiX3NldExhc3RFcnJvclJlc3BvbnNlIiwiJGh0dHBQYXJhbVNlcmlhbGl6ZXIiLCJwYXJhbXMiLCJ1cmwiLCJyZXNwb25zZU9yUmVqZWN0aW9uIiwibm90aWZpY2F0aW9uIiwiaTE4biIsInNraXBHbG9iYWxFcnJvck1lc3NhZ2UiLCJkYXRhIiwibWVzc2FnZSIsImVycm9yIiwiYXV0aCIsImp3dCIsImdldFRva2VuIiwiaXNFeHBpcmVkIiwicmVmcmVzaCIsImZhY3RvcnkiLCJodHRwSW50ZXJjZXB0b3IiLCJpbnN0YW50aWF0ZSIsIkFOR1VMQVJfTU9EVUxFIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztD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QUFRNkIsRUFBSUMsVUFDaEIsS0FBSzlCLEVBQ0gsTUFBTyxLQUtULElBQUk2QixFQUFJRSxVQUFVL0IsRUFBTyxLQUFNLENBQzdCLEdBQUlELEdBQWtCLFdBQ3BCLE1BQU84QixHQUFJQyxZQUdUNUIsRUFBa0IsV0FDcEIsTUFBTyxNQUdULE9BQU8wQixHQUFLSSxVQUFVeEIsS0FDcEJULEVBQ0FHLEdBS0osTUFBTzJCLEdBQUlDLFlBTWJwRCxFQUFRRCxPQUFPQSxHQUFRd0QsUUFBUSxtQkFBbUIsWUFBWSxTQUFTckQsR0FFbkUsR0FBSXNELEdBQWtCdEQsRUFBVXVELFlBQVl4RCxFQUU1QyxRQUNFWSxRQUFTLFdBQVksTUFBTzJDLEdBQWdCM0MsV0FDNUNGLGdCQUFpQixXQUFZLE1BQU82QyxHQUFnQjdDLG1CQUNwREYscUJBQXNCLFdBQVksTUFBTytDLEdBQWdCL0Msd0JBQ3pERix1QkFBd0IsV0FBWSxNQUFPaUQsR0FBZ0JqRCwwQkFDM0RPLFFBQVMsU0FBU0MsR0FBUyxNQUFPeUMsR0FBZ0IxQyxRQUFRQyxJQUMxRG1CLFNBQVUsU0FBU0EsR0FBVyxNQUFPc0IsR0FBZ0J0QixTQUFTQSxJQUM5REgsYUFBYyxTQUFTQyxHQUFZLE1BQU93QixHQUFnQm5CLGNBQWNMLElBQ3hFSyxjQUFlLFNBQVNMLEdBQVksTUFBT3dCLEdBQWdCbkIsY0FBY0wsU0FJOUUwQixlQUFnQjFEIiwiZmlsZSI6ImFwcC9zZXJ2aWNlcy9odHRwLWludGVyY2VwdG9yLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBBTkdVTEFSX01PRFVMRSwgYW5ndWxhciAqL1xuKGZ1bmN0aW9uKG1vZHVsZSwgYW5ndWxhcikge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIEh0dHBJbnRlcmNlcHRvciA9IGZ1bmN0aW9uKCRpbmplY3RvcilcbiAgICB7XG4gICAgICB0aGlzLiRpbmplY3RvciA9ICRpbmplY3RvcjtcbiAgICAgIHRoaXMuX3VybHMgPSB7fTtcbiAgICB9O1xuXG4gIC8qKiBAdmFyIHtBcnJheS48c3RyaW5nPn0gJGluamVjdCBEZXBlbmRlbmNpZXMgdG8gYmUgaW5qZWN0ZWQgYnkgQW5ndWxhci4gKi9cbiAgSHR0cEludGVyY2VwdG9yLiRpbmplY3QgPSBbJyRpbmplY3RvciddO1xuXG4gIC8qKlxuICAgKiBHZXRzIGxhdGVzdCByZXNwb25zZSBmcm9tICRodHRwLlxuICAgKi9cbiAgSHR0cEludGVyY2VwdG9yLnByb3RvdHlwZS5nZXRMYXN0U3VjY2Vzc1Jlc3BvbnNlID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIHJldHVybiB0aGlzLl9sYXN0U3VjY2Vzc1Jlc3BvbnNlO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIEdldHMgbGF0ZXN0IGVycm9yIGZyb20gJGh0dHAuXG4gICAqL1xuICBIdHRwSW50ZXJjZXB0b3IucHJvdG90eXBlLmdldExhc3RFcnJvclJlc3BvbnNlID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIHJldHVybiB0aGlzLl9sYXN0RXJyb3JSZXNwb25zZTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBHZXRzIGxhdGVzdCByZXNwb25zZSBmcm9tICRodHRwLlxuICAgKi9cbiAgSHR0cEludGVyY2VwdG9yLnByb3RvdHlwZS5nZXRMYXN0UmVzcG9uc2UgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgcmV0dXJuIHRoaXMuX2xhc3RSZXNwb25zZTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgaGFzaCBvZiBhbGwgcmVxdWVzdGVkIHVybHMuXG4gICAqL1xuICBIdHRwSW50ZXJjZXB0b3IucHJvdG90eXBlLmdldFVybHMgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgcmV0dXJuIHRoaXMuX3VybHM7XG4gICAgfTtcblxuICAvKipcbiAgICogSW50ZXJjZXB0cyAkaHR0cCByZXF1ZXN0J3MgY29uZmlnIGJlZm9yZSBpbnZvY2F0aW9uLlxuICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnXG4gICAqIEByZXR1cm4ge29iamVjdH0gY29uZmlnXG4gICAqL1xuICBIdHRwSW50ZXJjZXB0b3IucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbihjb25maWcpXG4gICAge1xuICAgICAgdmFyIGFwcFN0YXRlID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCdhcHBTdGF0ZScpO1xuXG4gICAgICAvLyBzZXQgYXBwIHN0YXRlIHRvIGJ1c3lcbiAgICAgIGFwcFN0YXRlLmh0dHBCdXN5ID0gdHJ1ZTtcblxuICAgICAgLy8gc2F2ZSB1cmwgaW4gaW50ZXJuYWwgY2FjaGVcbiAgICAgIHRoaXMuX3NldFVybChjb25maWcpO1xuXG4gICAgICAvLyBjb21tb24gaGVhZGVyc1xuICAgICAgY29uZmlnLmhlYWRlcnNbJ1gtUmVxdWVzdGVkLVdpdGgnXSA9ICdYTUxIdHRwUmVxdWVzdCc7XG5cbiAgICAgIC8vIGN1c3RvbSBzZXR0aW5nc1xuICAgICAgLypcbiAgICAgIHN3aXRjaChjb25maWcubWV0aG9kKVxuICAgICAge1xuICAgICAgICBjYXNlICdQT1NUJzpcbiAgICAgICAgY2FzZSAnUFVUJzpcbiAgICAgICAgICB2YXIgJGh0dHBQYXJhbVNlcmlhbGl6ZXIgPSB0aGlzLiRpbmplY3Rvci5nZXQoJyRodHRwUGFyYW1TZXJpYWxpemVyJyk7XG4gICAgICAgICAgY29uZmlnLmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCc7XG4gICAgICAgICAgY29uZmlnLmRhdGEgPSAkaHR0cFBhcmFtU2VyaWFsaXplcihjb25maWcuZGF0YSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgIH1cbiAgICAgICovXG5cbiAgICAgIC8vIEpXVCBhdXRob3JpemF0aW9uXG4gICAgICB2YXIgc3VjY2Vzc0NhbGxiYWNrID0gZnVuY3Rpb24odG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIHRva2VuO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgIH07XG5cbiAgICAgIHZhciBmYWlsdXJlQ2FsbGJhY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgIH07XG5cbiAgICAgIGlmIChjb25maWcuc2tpcEF1dGhvcml6YXRpb24pIHtcbiAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgIH1cblxuICAgICAgdmFyIGp3dFRva2VuID0gdGhpcy5fZ2V0SldUVG9rZW4oY29uZmlnKTtcbiAgICAgIHZhciAkcSA9IHRoaXMuJGluamVjdG9yLmdldCgnJHEnKTtcbiAgICAgIHJldHVybiAkcS53aGVuKGp3dFRva2VuKS50aGVuKFxuICAgICAgICBzdWNjZXNzQ2FsbGJhY2ssXG4gICAgICAgIGZhaWx1cmVDYWxsYmFja1xuICAgICAgKTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBJbnRlcmNlcHRzICRodHRwIHJlcXVlc3QgZXJyb3IncyBjb25maWcgYmVmb3JlIGludm9jYXRpb24uXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWdcbiAgICogQHJldHVybiB7b2JqZWN0fSBjb25maWdcbiAgICovXG4gIEh0dHBJbnRlcmNlcHRvci5wcm90b3R5cGUucmVxdWVzdEVycm9yID0gZnVuY3Rpb24ocmVqZWN0aW9uKVxuICAgIHtcbiAgICAgIHZhciBhcHBTdGF0ZSA9IHRoaXMuJGluamVjdG9yLmdldCgnYXBwU3RhdGUnKTtcbiAgICAgIHZhciAkcSA9IHRoaXMuJGluamVjdG9yLmdldCgnJHEnKTtcblxuICAgICAgYXBwU3RhdGUuaHR0cEJ1c3kgPSBmYWxzZTtcblxuICAgICAgcmV0dXJuICRxLnJlamVjdChyZWplY3Rpb24pO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIEludGVyY2VwdHMgJGh0dHAgcmVzcG9uc2UgYmVmb3JlIGZvcndhcmRpbmcuXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWdcbiAgICogQHJldHVybiB7b2JqZWN0fSBjb25maWdcbiAgICovXG4gIEh0dHBJbnRlcmNlcHRvci5wcm90b3R5cGUucmVzcG9uc2UgPSBmdW5jdGlvbihyZXNwb25zZSlcbiAgICB7XG4gICAgICB2YXIgYXBwU3RhdGUgPSB0aGlzLiRpbmplY3Rvci5nZXQoJ2FwcFN0YXRlJyk7XG5cbiAgICAgIHRoaXMuX3NldExhc3RTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgICAgdGhpcy5fc2V0TGFzdFJlc3BvbnNlKHJlc3BvbnNlKTtcblxuICAgICAgYXBwU3RhdGUuaHR0cEJ1c3kgPSBmYWxzZTtcblxuICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIEludGVyY2VwdHMgJGh0dHAgZXJyb3IgcmVzcG9uc2UgYmVmb3JlIGZvcndhcmRpbmcuXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWdcbiAgICogQHJldHVybiB7b2JqZWN0fSBjb25maWdcbiAgICovXG4gIEh0dHBJbnRlcmNlcHRvci5wcm90b3R5cGUucmVzcG9uc2VFcnJvciA9IGZ1bmN0aW9uKHJlamVjdGlvbilcbiAgICB7XG4gICAgICB2YXIgYXBwU3RhdGUgPSB0aGlzLiRpbmplY3Rvci5nZXQoJ2FwcFN0YXRlJyk7XG4gICAgICB2YXIgJHEgPSB0aGlzLiRpbmplY3Rvci5nZXQoJyRxJyk7XG5cbiAgICAgIHRoaXMuX3Nob3dHbG9iYWxFcnJvck1lc3NhZ2UocmVqZWN0aW9uKTtcbiAgICAgIHRoaXMuX3NldExhc3RFcnJvclJlc3BvbnNlKHJlamVjdGlvbik7XG4gICAgICB0aGlzLl9zZXRMYXN0UmVzcG9uc2UocmVqZWN0aW9uKTtcblxuICAgICAgYXBwU3RhdGUuaHR0cEJ1c3kgPSBmYWxzZTtcblxuICAgICAgcmV0dXJuICRxLnJlamVjdChyZWplY3Rpb24pO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIFNldHMgZnVsbHkgcXVhbGlmaWVkIHVybCB3aXRoIHF1ZXJ5IHN0cmluZyBmb3IgYSByZXF1ZXN0LlxuICAgKiBUaGlzIGlzIHVzZWZ1bCB0byBtYW5hZ2UgQW5ndWxhcidzICRjYWNoZUZhY3RvcnkgZm9yICRodHRwLlxuICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnXG4gICAqL1xuICBIdHRwSW50ZXJjZXB0b3IucHJvdG90eXBlLl9zZXRVcmwgPSBmdW5jdGlvbihjb25maWcpXG4gICAge1xuICAgICAgdmFyICRodHRwUGFyYW1TZXJpYWxpemVyID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCckaHR0cFBhcmFtU2VyaWFsaXplcicpO1xuICAgICAgdmFyIHBhcmFtcyA9ICRodHRwUGFyYW1TZXJpYWxpemVyKGNvbmZpZy5wYXJhbXMpO1xuICAgICAgdmFyIHVybCA9IGNvbmZpZy51cmwgKyAoXG4gICAgICAgIHBhcmFtcyA/XG4gICAgICAgICAgJz8nICsgcGFyYW1zIDpcbiAgICAgICAgICAnJ1xuICAgICAgKTtcblxuICAgICAgdGhpcy5fdXJsc1t1cmxdID0gdHJ1ZTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBIdHRwSW50ZXJjZXB0b3IucHJvdG90eXBlLl9zZXRMYXN0UmVzcG9uc2UgPSBmdW5jdGlvbihyZXNwb25zZU9yUmVqZWN0aW9uKVxuICAgIHtcbiAgICAgIHRoaXMuX2xhc3RSZXNwb25zZSA9IHJlc3BvbnNlT3JSZWplY3Rpb247XG4gICAgfTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgSHR0cEludGVyY2VwdG9yLnByb3RvdHlwZS5fc2V0TGFzdEVycm9yUmVzcG9uc2UgPSBmdW5jdGlvbihyZWplY3Rpb24pXG4gICAge1xuICAgICAgdGhpcy5fbGFzdEVycm9yUmVzcG9uc2UgPSByZWplY3Rpb247XG4gICAgfTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgSHR0cEludGVyY2VwdG9yLnByb3RvdHlwZS5fc2V0TGFzdFN1Y2Nlc3NSZXNwb25zZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKVxuICAgIHtcbiAgICAgIHRoaXMuX2xhc3RTdWNjZXNzUmVzcG9uc2UgPSByZXNwb25zZTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBIdHRwSW50ZXJjZXB0b3IucHJvdG90eXBlLl9zaG93R2xvYmFsRXJyb3JNZXNzYWdlID0gZnVuY3Rpb24ocmVqZWN0aW9uKVxuICB7XG4gICAgdmFyIG5vdGlmaWNhdGlvbiA9IHRoaXMuJGluamVjdG9yLmdldCgnbm90aWZpY2F0aW9uJyk7XG4gICAgdmFyIGkxOG4gPSB0aGlzLiRpbmplY3Rvci5nZXQoJ2kxOG4nKTtcblxuICAgIHZhciBjb25maWcgPSByZWplY3Rpb24uY29uZmlnIHx8wqB7fTtcbiAgICBpZiAoY29uZmlnLnNraXBHbG9iYWxFcnJvck1lc3NhZ2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgZGF0YSA9IHJlamVjdGlvbi5kYXRhIHx8wqB7fTtcbiAgICBpZiAoIWRhdGEubWVzc2FnZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIG5vdGlmaWNhdGlvbi5lcnJvcihpMThuLmdldChkYXRhLm1lc3NhZ2UpKTtcbiAgfTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgSHR0cEludGVyY2VwdG9yLnByb3RvdHlwZS5fZ2V0SldUVG9rZW4gPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgYXV0aCA9IHRoaXMuJGluamVjdG9yLmdldCgnYXV0aCcpO1xuICAgIHZhciBqd3QgPSB0aGlzLiRpbmplY3Rvci5nZXQoJ2p3dCcpO1xuXG4gICAgLy8gYSkgbm8gdG9rZW4gYXZhaWxhYmxlIGluIHN0b3JhZ2VcbiAgICB2YXIgdG9rZW4gPSBqd3QuZ2V0VG9rZW4oKTtcbiAgICBpZiAoIXRva2VuKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBiKSB0b2tlbiBpcyBzdGlsbCB2YWxpZCwgY2hlY2sgZm9yXG4gICAgLy8gcmVmcmVzaCBpZiBpdCBleHBpcmVzIGluIDUgbWludXRlc1xuICAgIGlmIChqd3QuaXNFeHBpcmVkKHRva2VuLCA2MDApKSB7XG4gICAgICB2YXIgc3VjY2Vzc0NhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBqd3QuZ2V0VG9rZW4oKTtcbiAgICAgIH07XG5cbiAgICAgIHZhciBmYWlsdXJlQ2FsbGJhY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gYXV0aC5yZWZyZXNoKCkudGhlbihcbiAgICAgICAgc3VjY2Vzc0NhbGxiYWNrLFxuICAgICAgICBmYWlsdXJlQ2FsbGJhY2tcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gYykgdXNlIGN1cnJlbnQgdG9rZW5cbiAgICByZXR1cm4gand0LmdldFRva2VuKCk7XG4gIH07XG5cbiAgLy9cbiAgLy8gUkVHSVNUUllcbiAgLy9cbiAgYW5ndWxhci5tb2R1bGUobW9kdWxlKS5mYWN0b3J5KCdodHRwSW50ZXJjZXB0b3InLFsnJGluamVjdG9yJyxmdW5jdGlvbigkaW5qZWN0b3Ipe1xuXG4gICAgICB2YXIgaHR0cEludGVyY2VwdG9yID0gJGluamVjdG9yLmluc3RhbnRpYXRlKEh0dHBJbnRlcmNlcHRvcik7XG5cbiAgICAgIHJldHVybiB7IC8vIGltcG9ydGFudDogJGh0dHAgc2VydmljZSBpbnZva2VzIHRoaXMgbWV0aG9kcyB3aXRoIGdsb2JhbCBzY29wZSFcbiAgICAgICAgZ2V0VXJsczogZnVuY3Rpb24oKXsgcmV0dXJuIGh0dHBJbnRlcmNlcHRvci5nZXRVcmxzKCk7IH0sXG4gICAgICAgIGdldExhc3RSZXNwb25zZTogZnVuY3Rpb24oKXsgcmV0dXJuIGh0dHBJbnRlcmNlcHRvci5nZXRMYXN0UmVzcG9uc2UoKTsgfSxcbiAgICAgICAgZ2V0TGFzdEVycm9yUmVzcG9uc2U6IGZ1bmN0aW9uKCl7IHJldHVybiBodHRwSW50ZXJjZXB0b3IuZ2V0TGFzdEVycm9yUmVzcG9uc2UoKTsgfSxcbiAgICAgICAgZ2V0TGFzdFN1Y2Nlc3NSZXNwb25zZTogZnVuY3Rpb24oKXsgcmV0dXJuIGh0dHBJbnRlcmNlcHRvci5nZXRMYXN0U3VjY2Vzc1Jlc3BvbnNlKCk7IH0sXG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uKGNvbmZpZyl7IHJldHVybiBodHRwSW50ZXJjZXB0b3IucmVxdWVzdChjb25maWcpOyB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24ocmVzcG9uc2UpeyByZXR1cm4gaHR0cEludGVyY2VwdG9yLnJlc3BvbnNlKHJlc3BvbnNlKTsgfSxcbiAgICAgICAgcmVxdWVzdEVycm9yOiBmdW5jdGlvbihyZWplY3Rpb24peyByZXR1cm4gaHR0cEludGVyY2VwdG9yLnJlc3BvbnNlRXJyb3IocmVqZWN0aW9uKTsgfSxcbiAgICAgICAgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24ocmVqZWN0aW9uKXsgcmV0dXJuIGh0dHBJbnRlcmNlcHRvci5yZXNwb25zZUVycm9yKHJlamVjdGlvbik7IH1cbiAgICAgIH07XG4gICAgfV0pO1xuXG59KShBTkdVTEFSX01PRFVMRSwgYW5ndWxhcik7XG4iXX0=
