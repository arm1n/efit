/*!
 * eFit Website
 * An app for financial training in educational environments
 * http://www.e-fit.com
 * @author Armin Pfurtscheller
 * @version 1.0.0
 * Copyright 2017. MIT licensed.
 */
!function(t,i){"use strict";var e=function(t){this.$injector=t,this._states=[t.get("STATE_BEGINNER"),t.get("STATE_AMATEUR"),t.get("STATE_ADVANCED"),t.get("STATE_EXPERT")],this._eventSource=null,this._payload={},this._pending={},this._tasks={}};e.$inject=["$injector"],e.prototype.state=null,e.prototype.group=null,e.prototype.tickets=null,e.prototype.load=function(){var t=this.$injector.get("User"),i=this,e=function(t){i._payload=t.toJSON(),i._initTickets(),i._initState(),i._initGroup(),i.isUser()&&(i._initWatches(),i._initPending(),i._initTasks(),i._initSSE())},n=function(){},s=t.current();return s.$promise.then(e,n),s},e.prototype.unload=function(){var t=this.$injector.get("sse");this._eventSource&&t.removeSource(this._eventSource),this._unwatchTickets&&this._unwatchTickets(),this._unwatchState&&this._unwatchState(),this._eventSource=null,this._payload={},this._pending={},this._tasks={},this.tickets=null,this.state=null,this.group=null},e.prototype.update=function(t){this._payload=t,this._initTickets(),this._initState(),this._initGroup()},e.prototype.isUser=function(){return this.hasRole("ROLE_USER")},e.prototype.isAdmin=function(){return this.hasRole("ROLE_ADMIN")},e.prototype.isSuperAdmin=function(){return this.hasRole("ROLE_SUPER_ADMIN")},e.prototype.isInWorkshop=function(){return!this.isUser()||this._payload.workshop.isActive},e.prototype.hasRole=function(t){i.isArray(t)||(t=[t]);for(var e=this._payload.roles||[],n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1},e.prototype.getTaskByType=function(t){return this._tasks[t]||null},e.prototype.getPendingByType=function(t){return this._pending[t]||null},e.prototype.getGroupAsString=function(){switch(this.group){case this.$injector.get("GROUP_A"):return"GROUP_A";case this.$injector.get("GROUP_B"):return"GROUP_B";default:return null}},e.prototype.getStateAsString=function(){switch(this.state){case this.$injector.get("STATE_AMATEUR"):return"STATE_AMATEUR";case this.$injector.get("STATE_ADVANCED"):return"STATE_ADVANCED";case this.$injector.get("STATE_EXPERT"):return"STATE_EXPERT";default:return"STATE_BEGINNER"}},e.prototype._initState=function(){var t=this.$injector.get("STATE_BEGINNER");this.state=this._payload.state||t},e.prototype._initGroup=function(){this.group=this._payload.group||null},e.prototype._initTickets=function(){var t=this._payload.tickets;this.tickets=t||0},e.prototype._initWatches=function(){var t=this.$injector.get("notification"),i=this.$injector.get("$rootScope"),e=this.$injector.get("i18n"),n=this,s=function(){return n.state},o=function(i,s){i!==s&&t.success(e.get("Congratulations, you have reached the state %s!",e.get(n.getStateAsString())))},r=function(){return n.tickets},a=function(i,n){if(i!==n){var s=i-n;if(!(s<0)){var o=1===s?e.get("Congratulations, you have earned 1 new ticket!"):e.get("Congratulations, you have earned %s new tickets!",s);t.primary(o)}}};this._unwatchTickets=i.$watch(r,a),this._unwatchState=i.$watch(s,o)},e.prototype._initSSE=function(){var t=this.$injector.get("$rootScope"),e=this.$injector.get("API_URL"),n=this.$injector.get("sse"),s=this._payload.workshop;if(s.isActive){var o=this,r=function(e){t.$evalAsync(function(){i.forEach(e,function(t){var i=Date.parse(t.updatedAt),e=o._tasks[t.type];e.isActive=!!t.isActive,isNaN(i)||(t.updatedAt=i)})})},a=e+"/sse/workshop/"+s.id+"/tasks",c={onMessage:r,sleep:1};this._eventSource=n.addSource(a,c)}},e.prototype._initTasks=function(){var t=this._payload.workshop;if(t){var e=this;i.forEach(t.tasks,function(t){e._tasks[t.type]=t})}},e.prototype._initPending=function(){var t=this._payload.pending;if(t){var e=this;i.forEach(t,function(t){e._pending[t.task.type]=t})}},i.module(t).service("user",e)}(ANGULAR_MODULE,angular);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zZXJ2aWNlcy91c2VyLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImFuZ3VsYXIiLCJVc2VyIiwiJGluamVjdG9yIiwidGhpcyIsIl9zdGF0ZXMiLCJnZXQiLCJfZXZlbnRTb3VyY2UiLCJfcGF5bG9hZCIsIl9wZW5kaW5nIiwiX3Rhc2tzIiwiJGluamVjdCIsInByb3RvdHlwZSIsInN0YXRlIiwiZ3JvdXAiLCJ0aWNrZXRzIiwibG9hZCIsIm1lIiwic3VjY2Vzc0NhbGxiYWNrIiwidXNlciIsInRvSlNPTiIsIl9pbml0VGlja2V0cyIsIl9pbml0U3RhdGUiLCJfaW5pdEdyb3VwIiwiaXNVc2VyIiwiX2luaXRXYXRjaGVzIiwiX2luaXRQZW5kaW5nIiwiX2luaXRUYXNrcyIsIl9pbml0U1NFIiwiZmFpbHVyZUNhbGxiYWNrIiwiY3VycmVudCIsIiRwcm9taXNlIiwidGhlbiIsInVubG9hZCIsInNzZSIsInJlbW92ZVNvdXJjZSIsIl91bndhdGNoVGlja2V0cyIsIl91bndhdGNoU3RhdGUiLCJ1cGRhdGUiLCJoYXNSb2xlIiwiaXNBZG1pbiIsImlzU3VwZXJBZG1pbiIsImlzSW5Xb3Jrc2hvcCIsIndvcmtzaG9wIiwiaXNBY3RpdmUiLCJyb2xlIiwiaXNBcnJheSIsInJvbGVzIiwiaSIsImxlbmd0aCIsImluZGV4T2YiLCJnZXRUYXNrQnlUeXBlIiwidHlwZSIsImdldFBlbmRpbmdCeVR5cGUiLCJnZXRHcm91cEFzU3RyaW5nIiwiZ2V0U3RhdGVBc1N0cmluZyIsIlNUQVRFX0JFR0lOTkVSIiwibm90aWZpY2F0aW9uIiwiJHJvb3RTY29wZSIsImkxOG4iLCJfd2F0Y2hTdGF0ZUV4cHJlc3Npb24iLCJfd2F0Y2hTdGF0ZUNhbGxiYWNrIiwibmV3U3RhdGUiLCJvbGRTdGF0ZSIsInN1Y2Nlc3MiLCJfd2F0Y2hUaWNrZXRzRXhwcmVzc2lvbiIsIl93YXRjaFRpY2tldHNDYWxsYmFjayIsIm5ld1RpY2tldHMiLCJvbGRUaWNrZXRzIiwibWVzc2FnZSIsInByaW1hcnkiLCIkd2F0Y2giLCJBUElfVVJMIiwiX29uTWVzc2FnZSIsImRhdGEiLCIkZXZhbEFzeW5jIiwiZm9yRWFjaCIsIml0ZW0iLCJ1bml4IiwiRGF0ZSIsInBhcnNlIiwidXBkYXRlZEF0IiwidGFzayIsImlzTmFOIiwidXJsIiwiaWQiLCJvcHRpb25zIiwib25NZXNzYWdlIiwic2xlZXAiLCJhZGRTb3VyY2UiLCJ0YXNrcyIsInBlbmRpbmciLCJyZXN1bHQiLCJzZXJ2aWNlIiwiQU5HVUxBUl9NT0RVTEUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0NBU0EsU0FBVUEsRUFBUUMsR0FDaEIsWUFTQSxJQUFJQyxHQUFPLFNBQVNDLEdBQ2xCQyxLQUFLRCxVQUFZQSxFQUVqQkMsS0FBS0MsU0FDSEYsRUFBVUcsSUFBSSxrQkFDZEgsRUFBVUcsSUFBSSxpQkFDZEgsRUFBVUcsSUFBSSxrQkFDZEgsRUFBVUcsSUFBSSxpQkFHaEJGLEtBQUtHLGFBQWUsS0FDcEJILEtBQUtJLFlBQ0xKLEtBQUtLLFlBQ0xMLEtBQUtNLFVBR1BSLEdBQUtTLFNBQVcsYUFPaEJULEVBQUtVLFVBQVVDLE1BQVEsS0FHdkJYLEVBQUtVLFVBQVVFLE1BQVEsS0FHdkJaLEVBQUtVLFVBQVVHLFFBQVUsS0FhekJiLEVBQUtVLFVBQVVJLEtBQU8sV0FDcEIsR0FBSWQsR0FBT0UsS0FBS0QsVUFBVUcsSUFBSSxRQUUxQlcsRUFBS2IsS0FDTGMsRUFBa0IsU0FBU0MsR0FJN0JGLEVBQUdULFNBQVdXLEVBQUtDLFNBR25CSCxFQUFHSSxlQUNISixFQUFHSyxhQUNITCxFQUFHTSxhQUlFTixFQUFHTyxXQUlSUCxFQUFHUSxlQUNIUixFQUFHUyxlQUNIVCxFQUFHVSxhQUNIVixFQUFHVyxhQUdEQyxFQUFrQixhQUlsQkMsRUFBVTVCLEVBQUs0QixTQU9uQixPQUxBQSxHQUFRQyxTQUFTQyxLQUNmZCxFQUNBVyxHQUdLQyxHQVVUNUIsRUFBS1UsVUFBVXFCLE9BQVMsV0FDdEIsR0FBSUMsR0FBTTlCLEtBQUtELFVBQVVHLElBQUksTUFFekJGLE1BQUtHLGNBQ1AyQixFQUFJQyxhQUFhL0IsS0FBS0csY0FHcEJILEtBQUtnQyxpQkFDUGhDLEtBQUtnQyxrQkFHSGhDLEtBQUtpQyxlQUNQakMsS0FBS2lDLGdCQUdQakMsS0FBS0csYUFBZSxLQUNwQkgsS0FBS0ksWUFDTEosS0FBS0ssWUFDTEwsS0FBS00sVUFFTE4sS0FBS1csUUFBVSxLQUNmWCxLQUFLUyxNQUFRLEtBQ2JULEtBQUtVLE1BQVEsTUFnQmZaLEVBQUtVLFVBQVUwQixPQUFTLFNBQVNuQixHQUMvQmYsS0FBS0ksU0FBV1csRUFFaEJmLEtBQUtpQixlQUNMakIsS0FBS2tCLGFBQ0xsQixLQUFLbUIsY0FVUHJCLEVBQUtVLFVBQVVZLE9BQVMsV0FDdEIsTUFBT3BCLE1BQUttQyxRQUFRLGNBVXRCckMsRUFBS1UsVUFBVTRCLFFBQVUsV0FDdkIsTUFBT3BDLE1BQUttQyxRQUFRLGVBVXRCckMsRUFBS1UsVUFBVTZCLGFBQWUsV0FDNUIsTUFBT3JDLE1BQUttQyxRQUFRLHFCQVV0QnJDLEVBQUtVLFVBQVU4QixhQUFlLFdBQzVCLE9BQUt0QyxLQUFLb0IsVUFJSHBCLEtBQUtJLFNBQVNtQyxTQUFTQyxVQVdoQzFDLEVBQUtVLFVBQVUyQixRQUFVLFNBQVNNLEdBQzNCNUMsRUFBUTZDLFFBQVFELEtBQ25CQSxHQUFRQSxHQUlWLEtBQUssR0FEREUsR0FBUTNDLEtBQUtJLFNBQVN1QyxVQUNqQkMsRUFBRSxFQUFHQSxFQUFFSCxFQUFLSSxPQUFRRCxJQUMzQixHQUFJRCxFQUFNRyxRQUFRTCxFQUFLRyxLQUFLLEVBQzFCLE9BQU8sQ0FJWCxRQUFPLEdBV1Q5QyxFQUFLVSxVQUFVdUMsY0FBZ0IsU0FBU0MsR0FDdEMsTUFBT2hELE1BQUtNLE9BQU8wQyxJQUFTLE1BVzlCbEQsRUFBS1UsVUFBVXlDLGlCQUFtQixTQUFTRCxHQUN6QyxNQUFPaEQsTUFBS0ssU0FBUzJDLElBQVMsTUFVaENsRCxFQUFLVSxVQUFVMEMsaUJBQW1CLFdBQ2hDLE9BQU9sRCxLQUFLVSxPQUNWLElBQUtWLE1BQUtELFVBQVVHLElBQUksV0FDdEIsTUFBTyxTQUNULEtBQUtGLE1BQUtELFVBQVVHLElBQUksV0FDdEIsTUFBTyxTQUNULFNBQ0UsTUFBTyxRQVdiSixFQUFLVSxVQUFVMkMsaUJBQW1CLFdBQ2hDLE9BQU9uRCxLQUFLUyxPQUNWLElBQUtULE1BQUtELFVBQVVHLElBQUksaUJBQ3RCLE1BQU8sZUFDVCxLQUFLRixNQUFLRCxVQUFVRyxJQUFJLGtCQUN0QixNQUFPLGdCQUNULEtBQUtGLE1BQUtELFVBQVVHLElBQUksZ0JBQ3RCLE1BQU8sY0FDVCxTQUNFLE1BQU8sbUJBV2JKLEVBQUtVLFVBQVVVLFdBQWEsV0FDMUIsR0FBSWtDLEdBQWlCcEQsS0FBS0QsVUFBVUcsSUFBSSxpQkFDeENGLE1BQUtTLE1BQVFULEtBQUtJLFNBQVNLLE9BQVMyQyxHQVV0Q3RELEVBQUtVLFVBQVVXLFdBQWEsV0FDMUJuQixLQUFLVSxNQUFRVixLQUFLSSxTQUFTTSxPQUFTLE1BVXRDWixFQUFLVSxVQUFVUyxhQUFlLFdBQzVCLEdBQUlOLEdBQVVYLEtBQUtJLFNBQVNPLE9BQzVCWCxNQUFLVyxRQUFVQSxHQUFXLEdBVzVCYixFQUFLVSxVQUFVYSxhQUFlLFdBQzVCLEdBQUlnQyxHQUFlckQsS0FBS0QsVUFBVUcsSUFBSSxnQkFDbENvRCxFQUFhdEQsS0FBS0QsVUFBVUcsSUFBSSxjQUNoQ3FELEVBQU92RCxLQUFLRCxVQUFVRyxJQUFJLFFBQzFCVyxFQUFLYixLQUVMd0QsRUFBd0IsV0FDMUIsTUFBTzNDLEdBQUdKLE9BR1JnRCxFQUFzQixTQUFTQyxFQUFVQyxHQUN2Q0QsSUFBYUMsR0FJakJOLEVBQWFPLFFBQ1hMLEVBQUtyRCxJQUNILGtEQUNBcUQsRUFBS3JELElBQUlXLEVBQUdzQyx1QkFLZFUsRUFBMEIsV0FDNUIsTUFBT2hELEdBQUdGLFNBR1JtRCxFQUF3QixTQUFTQyxFQUFZQyxHQUMvQyxHQUFJRCxJQUFlQyxFQUFuQixDQUdBLEdBQUlyRCxHQUFVb0QsRUFBYUMsQ0FDM0IsTUFBSXJELEVBQVUsR0FBZCxDQUlBLEdBQUlzRCxHQUFzQixJQUFadEQsRUFDWjRDLEVBQUtyRCxJQUFJLGtEQUNUcUQsRUFBS3JELElBQUksbURBQW9EUyxFQUUvRDBDLEdBQWFhLFFBQVFELEtBR3ZCakUsTUFBS2dDLGdCQUFrQnNCLEVBQVdhLE9BQ2hDTixFQUNBQyxHQUdGOUQsS0FBS2lDLGNBQWdCcUIsRUFBV2EsT0FDOUJYLEVBQ0FDLElBWUozRCxFQUFLVSxVQUFVZ0IsU0FBVyxXQUV0QixHQUFJOEIsR0FBYXRELEtBQUtELFVBQVVHLElBQUksY0FDaENrRSxFQUFVcEUsS0FBS0QsVUFBVUcsSUFBSSxXQUM3QjRCLEVBQU05QixLQUFLRCxVQUFVRyxJQUFJLE9BR3pCcUMsRUFBV3ZDLEtBQUtJLFNBQVNtQyxRQUM3QixJQUFLQSxFQUFTQyxTQUFkLENBSUEsR0FBSTNCLEdBQUtiLEtBRUxxRSxFQUFhLFNBQVNDLEdBQ3hCaEIsRUFBV2lCLFdBQVcsV0FDcEIxRSxFQUFRMkUsUUFBUUYsRUFBTSxTQUFTRyxHQUM3QixHQUFJQyxHQUFPQyxLQUFLQyxNQUFNSCxFQUFLSSxXQUN2QkMsRUFBT2pFLEVBQUdQLE9BQU9tRSxFQUFLekIsS0FDMUI4QixHQUFLdEMsV0FBYWlDLEVBQUtqQyxTQUVsQnVDLE1BQU1MLEtBQ1RELEVBQUtJLFVBQVlILFFBTXJCTSxFQUFNWixFQUFVLGlCQUFtQjdCLEVBQVMwQyxHQUFLLFNBQ2pEQyxHQUFZQyxVQUFXZCxFQUFZZSxNQUFPLEVBQzlDcEYsTUFBS0csYUFBZTJCLEVBQUl1RCxVQUFVTCxFQUFLRSxLQVczQ3BGLEVBQUtVLFVBQVVlLFdBQWEsV0FDMUIsR0FBSWdCLEdBQVd2QyxLQUFLSSxTQUFTbUMsUUFDN0IsSUFBS0EsRUFBTCxDQUlBLEdBQUkxQixHQUFLYixJQUNUSCxHQUFRMkUsUUFBUWpDLEVBQVMrQyxNQUFNLFNBQVNSLEdBQ3RDakUsRUFBR1AsT0FBT3dFLEVBQUs5QixNQUFROEIsTUFZM0JoRixFQUFLVSxVQUFVYyxhQUFlLFdBQzVCLEdBQUlpRSxHQUFVdkYsS0FBS0ksU0FBU21GLE9BQzVCLElBQUtBLEVBQUwsQ0FJQSxHQUFJMUUsR0FBS2IsSUFDVEgsR0FBUTJFLFFBQVFlLEVBQVEsU0FBU0MsR0FDL0IzRSxFQUFHUixTQUFTbUYsRUFBT1YsS0FBSzlCLE1BQVF3QyxNQU9wQzNGLEVBQVFELE9BQU9BLEdBQVE2RixRQUFRLE9BQVEzRixJQUV0QzRGLGVBQWdCN0YiLCJmaWxlIjoiYXBwL3NlcnZpY2VzL3VzZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIEFOR1VMQVJfTU9EVUxFLCBhbmd1bGFyICovXG4oZnVuY3Rpb24obW9kdWxlLCBhbmd1bGFyKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvL1xuICAvLyBTRVJWSUNFXG4gIC8vXG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgdmFyIFVzZXIgPSBmdW5jdGlvbigkaW5qZWN0b3IpIHtcbiAgICB0aGlzLiRpbmplY3RvciA9ICRpbmplY3RvcjtcblxuICAgIHRoaXMuX3N0YXRlcyA9IFtcbiAgICAgICRpbmplY3Rvci5nZXQoJ1NUQVRFX0JFR0lOTkVSJyksXG4gICAgICAkaW5qZWN0b3IuZ2V0KCdTVEFURV9BTUFURVVSJyksXG4gICAgICAkaW5qZWN0b3IuZ2V0KCdTVEFURV9BRFZBTkNFRCcpLFxuICAgICAgJGluamVjdG9yLmdldCgnU1RBVEVfRVhQRVJUJylcbiAgICBdO1xuXG4gICAgdGhpcy5fZXZlbnRTb3VyY2UgPSBudWxsO1xuICAgIHRoaXMuX3BheWxvYWQgPSB7fTtcbiAgICB0aGlzLl9wZW5kaW5nID0ge307XG4gICAgdGhpcy5fdGFza3MgPSB7fTtcbiAgfTtcblxuICBVc2VyLiRpbmplY3QgPSBbJyRpbmplY3RvciddO1xuXG4gIC8vXG4gIC8vIFBST1BFUlRJRVNcbiAgLy9cblxuICAvKiogQHZhciB7bnVtYmVyfSBzdGF0ZSBDdXJyZW50IHN0YXRlIG9mIHVzZXIuICovXG4gIFVzZXIucHJvdG90eXBlLnN0YXRlID0gbnVsbDtcblxuICAvKiogQHZhciB7bnVtYmVyfSBncm91cCBDdXJyZW50IHN0YXRlIG9mIHVzZXIuICovXG4gIFVzZXIucHJvdG90eXBlLmdyb3VwID0gbnVsbDtcblxuICAvKiogQHZhciB7bnVtYmVyfSB0aWNrZXRzIEN1cnJlbnQgc3RhdGUgb2YgdXNlci4gKi9cbiAgVXNlci5wcm90b3R5cGUudGlja2V0cyA9IG51bGw7XG5cbiAgLy9cbiAgLy8gTUVUSE9EU1xuICAvL1xuXG4gIC8qKlxuICAgKiBGZXRjaGVzIGN1cnJlbnQgdXNlciB0aHJvdWdoIGBVc2VyYCByZXNvdXJjZS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIGxvYWRcbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIFVzZXIucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgVXNlciA9IHRoaXMuJGluamVjdG9yLmdldCgnVXNlcicpO1xuXG4gICAgdmFyIG1lID0gdGhpcztcbiAgICB2YXIgc3VjY2Vzc0NhbGxiYWNrID0gZnVuY3Rpb24odXNlcikge1xuXG4gICAgICAvLyBzYXZlIG9ubHkganNvbiBwYXlsb2FkIGZyb21cbiAgICAgIC8vIG5nLXJlc291cmNlJ3MgYHVzZXJgIG9iamVjdFxuICAgICAgbWUuX3BheWxvYWQgPSB1c2VyLnRvSlNPTigpO1xuXG4gICAgICAvLyBpbml0aWFsaXplIG1lbWJlcnNcbiAgICAgIG1lLl9pbml0VGlja2V0cygpO1xuICAgICAgbWUuX2luaXRTdGF0ZSgpO1xuICAgICAgbWUuX2luaXRHcm91cCgpO1xuXG4gICAgICAvLyBnYW1lcGxheSBzZXR1cCBjYWxsc1xuICAgICAgLy8gb25seSBmb3IgYFJPTEVfVVNFUmAhXG4gICAgICBpZiAoIW1lLmlzVXNlcigpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWUuX2luaXRXYXRjaGVzKCk7XG4gICAgICBtZS5faW5pdFBlbmRpbmcoKTtcbiAgICAgIG1lLl9pbml0VGFza3MoKTtcbiAgICAgIG1lLl9pbml0U1NFKCk7XG4gICAgfTtcblxuICAgIHZhciBmYWlsdXJlQ2FsbGJhY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIG5vb3BcbiAgICB9O1xuXG4gICAgdmFyIGN1cnJlbnQgPSBVc2VyLmN1cnJlbnQoKTtcblxuICAgIGN1cnJlbnQuJHByb21pc2UudGhlbihcbiAgICAgIHN1Y2Nlc3NDYWxsYmFjayxcbiAgICAgIGZhaWx1cmVDYWxsYmFja1xuICAgICk7XG5cbiAgICByZXR1cm4gY3VycmVudDtcbiAgfTtcblxuICAvKipcbiAgICogUmVzZXRzIGN1cnJlbnQgdXNlciBzZXNzaW9uIGZyb20gYXBwbGljYXRpb24uXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCByZXNldFxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgVXNlci5wcm90b3R5cGUudW5sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNzZSA9IHRoaXMuJGluamVjdG9yLmdldCgnc3NlJyk7XG5cbiAgICBpZiAodGhpcy5fZXZlbnRTb3VyY2UpIHtcbiAgICAgIHNzZS5yZW1vdmVTb3VyY2UodGhpcy5fZXZlbnRTb3VyY2UpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl91bndhdGNoVGlja2V0cykge1xuICAgICAgdGhpcy5fdW53YXRjaFRpY2tldHMoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fdW53YXRjaFN0YXRlKSB7XG4gICAgICB0aGlzLl91bndhdGNoU3RhdGUoKTtcbiAgICB9XG5cbiAgICB0aGlzLl9ldmVudFNvdXJjZSA9IG51bGw7XG4gICAgdGhpcy5fcGF5bG9hZCA9IHt9O1xuICAgIHRoaXMuX3BlbmRpbmcgPSB7fTtcbiAgICB0aGlzLl90YXNrcyA9IHt9O1xuXG4gICAgdGhpcy50aWNrZXRzID0gbnVsbDtcbiAgICB0aGlzLnN0YXRlID0gbnVsbDtcbiAgICB0aGlzLmdyb3VwID0gbnVsbDtcbiAgfTtcblxuICAvKipcbiAgICogVXBkYXRlcyB1c2VyIGZyb20gZXh0ZXJuYWwgc2NvcGVzLlxuICAgKiBUaGlzIGlzIGhlbHBmdWwgZm9yIHJlZnJlc2hpbmcgaXRzXG4gICAqIHN0YXRlIHdpdGhvdXQgaW52b2tpbmcgYSByZXF1ZXN0IHRvXG4gICAqIHRoZSBzZXJ2ZXIgd2hlbiB1c2VyIHdhcyBlbWJlZGRlZCBpblxuICAgKiBhbm90aGVyIHJlcXVlc3QncyByZXNwb25zZS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIHVwZGF0ZVxuICAgKiBAcGFyYW0ge29iamVjdH0gdXNlclxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKlxuICAgKi9cbiAgVXNlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24odXNlcikge1xuICAgIHRoaXMuX3BheWxvYWQgPSB1c2VyO1xuXG4gICAgdGhpcy5faW5pdFRpY2tldHMoKTtcbiAgICB0aGlzLl9pbml0U3RhdGUoKTtcbiAgICB0aGlzLl9pbml0R3JvdXAoKTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGN1cnJlbnQgdXNlciBoYXMgcm9sZSBgUk9MRV9VU0VSYC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIGlzVXNlclxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgVXNlci5wcm90b3R5cGUuaXNVc2VyID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaGFzUm9sZSgnUk9MRV9VU0VSJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBjdXJyZW50IHVzZXIgaGFzIHJvbGUgYFJPTEVfQURNSU5gLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgaXNBZG1pblxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgVXNlci5wcm90b3R5cGUuaXNBZG1pbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmhhc1JvbGUoJ1JPTEVfQURNSU4nKTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGN1cnJlbnQgdXNlciBoYXMgcm9sZSBgUk9MRV9TVVBFUl9BRE1JTmAuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCBpc1N1cGVyQWRtaW5cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIFVzZXIucHJvdG90eXBlLmlzU3VwZXJBZG1pbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmhhc1JvbGUoJ1JPTEVfU1VQRVJfQURNSU4nKTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGN1cnJlbnQgdXNlcidzIHdvcmtzaG9wIGlzIGFjdGl2ZS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIGlzSW5Xb3Jrc2hvcFxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgVXNlci5wcm90b3R5cGUuaXNJbldvcmtzaG9wID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLmlzVXNlcigpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fcGF5bG9hZC53b3Jrc2hvcC5pc0FjdGl2ZTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGN1cnJlbnQgdXNlciBoYXMgZ2l2ZW4gcm9sZS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIGhhc1JvbGVcbiAgICogQHBhcmFtIHtzdHJpbmd8YXJyYXl9IHJvbGVcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIFVzZXIucHJvdG90eXBlLmhhc1JvbGUgPSBmdW5jdGlvbihyb2xlKSB7XG4gICAgaWYgKCFhbmd1bGFyLmlzQXJyYXkocm9sZSkpIHtcbiAgICAgIHJvbGUgPSBbcm9sZV07XG4gICAgfVxuXG4gICAgdmFyIHJvbGVzID0gdGhpcy5fcGF5bG9hZC5yb2xlcyB8fMKgW107XG4gICAgZm9yICh2YXIgaT0wOyBpPHJvbGUubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChyb2xlcy5pbmRleE9mKHJvbGVbaV0pPj0wKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICAvKipcbiAgICogR2V0cyBgdGFza2AgcmVzb3VyY2Ugb2YgdXNlciBieSB0eXBlLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgZ2V0VGFza0J5VHlwZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICAgKiBAcmV0dXJuIHtvYmplY3R8bnVsbH1cbiAgICovXG4gIFVzZXIucHJvdG90eXBlLmdldFRhc2tCeVR5cGUgPSBmdW5jdGlvbih0eXBlKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Rhc2tzW3R5cGVdIHx8wqBudWxsO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXRzIGByZXN1bHRgIHJlc291cmNlIG9mIHVzZXIgYnkgdHlwZS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIGdldFJlc3VsdEJ5VHlwZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICAgKiBAcmV0dXJuIHtvYmplY3R8bnVsbH1cbiAgICovXG4gIFVzZXIucHJvdG90eXBlLmdldFBlbmRpbmdCeVR5cGUgPSBmdW5jdGlvbih0eXBlKSB7XG4gICAgcmV0dXJuIHRoaXMuX3BlbmRpbmdbdHlwZV0gfHzCoG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldHMgYHN0YXRlYCBtYXBwZWQgdG8gc3RyaW5nIHJlcHJlc2VudGF0aW9uLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgZ2V0R3JvdXBBc1N0cmluZ1xuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuICBVc2VyLnByb3RvdHlwZS5nZXRHcm91cEFzU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgc3dpdGNoKHRoaXMuZ3JvdXApIHtcbiAgICAgIGNhc2UgdGhpcy4kaW5qZWN0b3IuZ2V0KCdHUk9VUF9BJyk6XG4gICAgICAgIHJldHVybiAnR1JPVVBfQSc7XG4gICAgICBjYXNlIHRoaXMuJGluamVjdG9yLmdldCgnR1JPVVBfQicpOlxuICAgICAgICByZXR1cm4gJ0dST1VQX0InO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBHZXRzIGBzdGF0ZWAgbWFwcGVkIHRvIHN0cmluZyByZXByZXNlbnRhdGlvbi5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIGdldFN0YXRlQXNTdHJpbmdcbiAgICogQHJldHVybiB7c3RyaW5nfVxuICAgKi9cbiAgVXNlci5wcm90b3R5cGUuZ2V0U3RhdGVBc1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7XG4gICAgICBjYXNlIHRoaXMuJGluamVjdG9yLmdldCgnU1RBVEVfQU1BVEVVUicpOlxuICAgICAgICByZXR1cm4gJ1NUQVRFX0FNQVRFVVInO1xuICAgICAgY2FzZSB0aGlzLiRpbmplY3Rvci5nZXQoJ1NUQVRFX0FEVkFOQ0VEJyk6XG4gICAgICAgIHJldHVybiAnU1RBVEVfQURWQU5DRUQnO1xuICAgICAgY2FzZSB0aGlzLiRpbmplY3Rvci5nZXQoJ1NUQVRFX0VYUEVSVCcpOlxuICAgICAgICByZXR1cm4gJ1NUQVRFX0VYUEVSVCc7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gJ1NUQVRFX0JFR0lOTkVSJztcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIGBzdGF0ZWAgbWVtYmVyLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAbWV0aG9kIF9pbml0U3RhdGVcbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIFVzZXIucHJvdG90eXBlLl9pbml0U3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgU1RBVEVfQkVHSU5ORVIgPSB0aGlzLiRpbmplY3Rvci5nZXQoJ1NUQVRFX0JFR0lOTkVSJyk7XG4gICAgdGhpcy5zdGF0ZSA9IHRoaXMuX3BheWxvYWQuc3RhdGUgfHzCoFNUQVRFX0JFR0lOTkVSO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplcyBgZ3JvdXBgIG1lbWJlci5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQG1ldGhvZCBfaW5pdEdyb3VwXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICBVc2VyLnByb3RvdHlwZS5faW5pdEdyb3VwID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5ncm91cCA9IHRoaXMuX3BheWxvYWQuZ3JvdXAgfHzCoG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIGB0aWNrZXRzYCBtZW1iZXIuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBtZXRob2QgaW5pdFxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgVXNlci5wcm90b3R5cGUuX2luaXRUaWNrZXRzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRpY2tldHMgPSB0aGlzLl9wYXlsb2FkLnRpY2tldHM7XG4gICAgdGhpcy50aWNrZXRzID0gdGlja2V0cyB8fMKgMDtcbiAgfTtcblxuICAvKipcbiAgICogV2F0Y2hlcyBgc3RhdGVgIGFuZCBgdGlja2V0c2AgZm9yIGNoYW5nZXMgdG9cbiAgICogc2hvdyB0aGUgY29ycmVzcG9uZGluZyB1c2VyIG5vdGlmaWNhdGlvbnMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBtZXRob2QgX2luaXRXYXRjaGVzXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICBVc2VyLnByb3RvdHlwZS5faW5pdFdhdGNoZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbm90aWZpY2F0aW9uID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCdub3RpZmljYXRpb24nKTtcbiAgICB2YXIgJHJvb3RTY29wZSA9IHRoaXMuJGluamVjdG9yLmdldCgnJHJvb3RTY29wZScpO1xuICAgIHZhciBpMThuID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCdpMThuJyk7XG4gICAgdmFyIG1lID0gdGhpcztcblxuICAgIHZhciBfd2F0Y2hTdGF0ZUV4cHJlc3Npb24gPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBtZS5zdGF0ZTtcbiAgICB9O1xuXG4gICAgdmFyIF93YXRjaFN0YXRlQ2FsbGJhY2sgPSBmdW5jdGlvbihuZXdTdGF0ZSwgb2xkU3RhdGUpIHtcbiAgICAgIGlmIChuZXdTdGF0ZSA9PT0gb2xkU3RhdGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBub3RpZmljYXRpb24uc3VjY2VzcyhcbiAgICAgICAgaTE4bi5nZXQoXG4gICAgICAgICAgJ0NvbmdyYXR1bGF0aW9ucywgeW91IGhhdmUgcmVhY2hlZCB0aGUgc3RhdGUgJXMhJyxcbiAgICAgICAgICBpMThuLmdldChtZS5nZXRTdGF0ZUFzU3RyaW5nKCkpXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfTtcblxuICAgIHZhciBfd2F0Y2hUaWNrZXRzRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG1lLnRpY2tldHM7XG4gICAgfTtcblxuICAgIHZhciBfd2F0Y2hUaWNrZXRzQ2FsbGJhY2sgPSBmdW5jdGlvbihuZXdUaWNrZXRzLCBvbGRUaWNrZXRzKSB7XG4gICAgICBpZiAobmV3VGlja2V0cyA9PT0gb2xkVGlja2V0cykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgdGlja2V0cyA9IG5ld1RpY2tldHMgLSBvbGRUaWNrZXRzO1xuICAgICAgaWYgKHRpY2tldHMgPCAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIG1lc3NhZ2UgPSB0aWNrZXRzID09PSAxID9cbiAgICAgICAgaTE4bi5nZXQoJ0NvbmdyYXR1bGF0aW9ucywgeW91IGhhdmUgZWFybmVkIDEgbmV3IHRpY2tldCEnKSA6XG4gICAgICAgIGkxOG4uZ2V0KCdDb25ncmF0dWxhdGlvbnMsIHlvdSBoYXZlIGVhcm5lZCAlcyBuZXcgdGlja2V0cyEnLCB0aWNrZXRzKTtcblxuICAgICAgbm90aWZpY2F0aW9uLnByaW1hcnkobWVzc2FnZSk7XG4gICAgfTtcblxuICAgIHRoaXMuX3Vud2F0Y2hUaWNrZXRzID0gJHJvb3RTY29wZS4kd2F0Y2goXG4gICAgICBfd2F0Y2hUaWNrZXRzRXhwcmVzc2lvbixcbiAgICAgIF93YXRjaFRpY2tldHNDYWxsYmFja1xuICAgICk7XG5cbiAgICB0aGlzLl91bndhdGNoU3RhdGUgPSAkcm9vdFNjb3BlLiR3YXRjaChcbiAgICAgIF93YXRjaFN0YXRlRXhwcmVzc2lvbixcbiAgICAgIF93YXRjaFN0YXRlQ2FsbGJhY2tcbiAgICApO1xuICB9O1xuXG5cbiAgLyoqXG4gICAqIERlc3Ryb3lzIHVzZXIgc2Vzc2lvbiBhbmQgcmVkaXJlY3RzIHRvIGxvZ2luLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAbWV0aG9kIF9pbml0U1NFXG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICBVc2VyLnByb3RvdHlwZS5faW5pdFNTRSA9IGZ1bmN0aW9uKClcbiAgICB7XG4gICAgICB2YXIgJHJvb3RTY29wZSA9IHRoaXMuJGluamVjdG9yLmdldCgnJHJvb3RTY29wZScpO1xuICAgICAgdmFyIEFQSV9VUkwgPSB0aGlzLiRpbmplY3Rvci5nZXQoJ0FQSV9VUkwnKTtcbiAgICAgIHZhciBzc2UgPSB0aGlzLiRpbmplY3Rvci5nZXQoJ3NzZScpO1xuXG4gICAgICAvLyBkb24ndCBzZXR1cCBTU0Ugd2hlbiBwbGF5aW5nIHJlbW90ZVxuICAgICAgdmFyIHdvcmtzaG9wID0gdGhpcy5fcGF5bG9hZC53b3Jrc2hvcDtcbiAgICAgIGlmICghd29ya3Nob3AuaXNBY3RpdmUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgbWUgPSB0aGlzO1xuXG4gICAgICB2YXIgX29uTWVzc2FnZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgJHJvb3RTY29wZS4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciB1bml4ID0gRGF0ZS5wYXJzZShpdGVtLnVwZGF0ZWRBdCk7XG4gICAgICAgICAgICB2YXIgdGFzayA9IG1lLl90YXNrc1tpdGVtLnR5cGVdO1xuICAgICAgICAgICAgdGFzay5pc0FjdGl2ZSA9ICEhaXRlbS5pc0FjdGl2ZTtcblxuICAgICAgICAgICAgaWYgKCFpc05hTih1bml4KSkge1xuICAgICAgICAgICAgICBpdGVtLnVwZGF0ZWRBdCA9IHVuaXg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgdmFyIHVybCA9IEFQSV9VUkwgKyAnL3NzZS93b3Jrc2hvcC8nICsgd29ya3Nob3AuaWQgKyAnL3Rhc2tzJztcbiAgICAgIHZhciBvcHRpb25zID0geyBvbk1lc3NhZ2U6IF9vbk1lc3NhZ2UsIHNsZWVwOiAxIH07XG4gICAgICB0aGlzLl9ldmVudFNvdXJjZSA9IHNzZS5hZGRTb3VyY2UodXJsLCBvcHRpb25zKTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBDYWNoZXMgdGFzayBoYXNoIG1hcCBmcm9tIHdvcmtzaG9wXG4gICAqIGZvciBsb29rdXBzIGZyb20gYGdldFRhc2tCeVR5cGUoKWAuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBtZXRob2QgX2luaXRUYXNrc1xuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgVXNlci5wcm90b3R5cGUuX2luaXRUYXNrcyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB3b3Jrc2hvcCA9IHRoaXMuX3BheWxvYWQud29ya3Nob3A7XG4gICAgaWYgKCF3b3Jrc2hvcCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBtZSA9IHRoaXM7XG4gICAgYW5ndWxhci5mb3JFYWNoKHdvcmtzaG9wLnRhc2tzLGZ1bmN0aW9uKHRhc2spIHtcbiAgICAgIG1lLl90YXNrc1t0YXNrLnR5cGVdID0gdGFzaztcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogQ2FjaGVzIHBlbmRpbmcgaGFzaCBtYXAgZnJvbSB3b3Jrc2hvcFxuICAgKiBmb3IgbG9va3VwcyBmcm9tIGBnZXRQZW5kaW5nQnlUeXBlKClgLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAbWV0aG9kIF9pbml0UGVuZGluZ1xuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgVXNlci5wcm90b3R5cGUuX2luaXRQZW5kaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBlbmRpbmcgPSB0aGlzLl9wYXlsb2FkLnBlbmRpbmc7XG4gICAgaWYgKCFwZW5kaW5nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG1lID0gdGhpcztcbiAgICBhbmd1bGFyLmZvckVhY2gocGVuZGluZyxmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgIG1lLl9wZW5kaW5nW3Jlc3VsdC50YXNrLnR5cGVdID0gcmVzdWx0O1xuICAgIH0pO1xuICB9O1xuXG4gIC8vXG4gIC8vIFJFR0lTVFJZXG4gIC8vXG4gIGFuZ3VsYXIubW9kdWxlKG1vZHVsZSkuc2VydmljZSgndXNlcicsIFVzZXIpO1xuXG59KShBTkdVTEFSX01PRFVMRSwgYW5ndWxhcik7XG4iXX0=
