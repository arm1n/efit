/*!
 * fastshell
 * Fiercely quick and opinionated front-ends
 * https://HosseinKarami.github.io/fastshell
 * @author Hossein Karami
 * @version 1.0.5
 * Copyright 2017. MIT licensed.
 */
!function(t){if("undefined"==typeof t)throw Error("Cannot initialize bomb task without angular!");var i=t.module("bombTask",[]);i.constant("DEFAULT_NUM_ROWS",5),i.constant("DEFAULT_NUM_COLS",5),i.constant("DEFAULT_WIDTH","75px"),i.constant("DEFAULT_HEIGHT","75px"),i.constant("DEFAULT_FEEDBACK",!0),i.constant("DEFAULT_UNDOABLE",!0),i.constant("DEFAULT_RANDOM",!1),i.constant("DEFAULT_DYNAMIC",!1),i.constant("DEFAULT_INTERVAL",1);var o=function(t,i,o,e){this._storageKey="bret_state",this.$injector=e,this.$interval=o,this.$filter=i,this.$scope=t,this.init()};o.$inject=["$scope","$filter","$interval","$injector"],o.prototype.init=function(){this._initInternals(),this._initSettings(),this._initWatches(),this._initMatrix(),this._initBomb(),this._initForm(),this._desist()},o.prototype.reset=function(){this._collectionUnwatchF(),this._bombUnwatchF(),this._removeState(),this.init()},o.prototype.start=function(t){if(this.dynamic){var i=this,o=this.iterator.length;this._intIndex=t||0,this._intervalId=i.$interval(function(){var t=i.iterator[i._intIndex];i.update(t,!0),i._intIndex++,i._intIndex===o&&i.stop()},1e3*this.interval,o-this._intIndex)}this.started=!0,this._persist()},o.prototype.stop=function(){this.dynamic&&this._intervalId&&this.$interval.cancel(this._intervalId),this.feedback||(this.resolved=!0),this.stopped=!0,this._persist()},o.prototype.resolve=function(){for(var t=0;t<this.collection.length;t++)this.collection[t].$$resolved=!0;this.resolved=!0,this._persist()},o.prototype.update=function(t,i){var o=this.collection.indexOf(t);i?(o<0&&this.collection.push(t),t.$$active=!0):o>=0&&(this.collection.splice(o,1),t.$$active=!1),this._persist()},o.prototype.isBomb=function(i){return t.equals(this.bomb,i)},o.prototype.hasBomb=function(){var t=this,i=this.$filter("filter")(this.collection,function(i){return t.isBomb(i)});return+(1===i.length)},o.prototype.getTotalBoxes=function(){return this.rows*this.cols},o.prototype.getCollectedBoxes=function(){return this.collection.length},o.prototype.getRemainingBoxes=function(){return this.getTotalBoxes()-this.getCollectedBoxes()},o.prototype._getConstant=function(t){return this.$injector.has(t)?this.$injector.get(t):this.$injector.get("DEFAULT_"+t)},o.prototype._getColumn=function(t){var i=t.row-1,o=t.col-1;return this.matrix[i][o]},o.prototype._getState=function(){return"undefined"!=typeof sessionStorage?t.fromJson(sessionStorage.getItem(this._storageKey)):null},o.prototype._setState=function(i){"undefined"!=typeof sessionStorage&&sessionStorage.setItem(this._storageKey,t.toJson(i))},o.prototype._removeState=function(){"undefined"!=typeof sessionStorage&&sessionStorage.removeItem(this._storageKey)},o.prototype._persist=function(){var t={bomb:this.bomb,started:this.started,stopped:this.stopped,resolved:this.resolved,collection:this.collection};this.dynamic&&(t.iterator=this.iterator,t._intIndex=this._intIndex),this._setState(t)},o.prototype._desist=function(){var t=this._getState();if(null!==t){if(this.bomb=this._getColumn(t.bomb),t.iterator){this.iterator=[];for(var i=0;i<t.iterator.length;i++){var o=this._getColumn(t.iterator[i]);this.iterator.push(o)}}for(var i=0;i<t.collection.length;i++){var o=this._getColumn(t.collection[i]);this.update(o,!0)}t.started&&this.start(t._intIndex),t.stopped&&this.stop(),t.resolved&&this.resolve()}},o.prototype._initSettings=function(){this.width=this._getConstant("WIDTH"),this.height=this._getConstant("HEIGHT"),this.rows=this._getConstant("NUM_ROWS"),this.cols=this._getConstant("NUM_COLS"),this.random=this._getConstant("RANDOM"),this.dynamic=this._getConstant("DYNAMIC"),this.interval=this._getConstant("INTERVAL"),this.feedback=this._getConstant("FEEDBACK"),this.undoable=this._getConstant("UNDOABLE")},o.prototype._initInternals=function(){this.collection=[],this.started=!1,this.stopped=!1,this.resolved=!1},o.prototype._initWatches=function(){var i=this;this._collectionUnwatchF=this.$scope.$watchCollection(function(){return i.collection},function(o){i.form.boxes_collected=o.length,i.form.boxes_scheme=t.toJson(o)}),this._bombUnwatchF=this.$scope.$watch(function(){return i.hasBomb()},function(o){i.form.bomb=o,i.form.bomb_location=t.toJson(i.bomb)})},o.prototype._initMatrix=function(){this.matrix=[],this.iterator=[];for(var t=0;t<this.rows;t++){for(var i=[],o=0;o<this.cols;o++){var e={row:t+1,col:o+1};i.push(e),this.dynamic&&(this.random?this._pushRandom(this.iterator,e):this.iterator.push(e))}this.matrix.push(i)}},o.prototype._initBomb=function(){var t=this._getRandom(0,this.rows-1),i=this._getRandom(0,this.cols-1);this.bomb=this.matrix[t][i]},o.prototype._initForm=function(){this.form={bomb:0,boxes_scheme:[],boxes_collected:0,bomb_location:null}},o.prototype._getRandom=function(t,i){return Math.floor(Math.random()*(i-t+1)+t)},o.prototype._pushRandom=function(t,i){var o=this._getRandom(0,t.length);return t.push(t[o]),t[o]=i,t.length},o.prototype._shuffleArray=function(t){for(var i=t.length-1;i>0;i--){var o=this._getRandom(0,i),e=t[i];t[i]=t[o],t[o]=e}return t},i.controller("BombTaskController",o);var e=function(){};e.prototype.model=null,e.prototype.isActive=!1,e.prototype.isDisabled=!1,e.prototype.isClickable=!0,e.prototype.toggle=function(){!this.isDisabled&&this.isClickable&&(this.isActive=!this.isActive,this.onToggle({model:this.model,state:this.isActive}))},i.directive("card",function(){return{scope:{model:"=card",onToggle:"&cardOnToggle",isActive:"=?cardIsActive",isDisabled:"=?cardIsDisabled",isClickable:"=?cardIsClickable"},restrict:"A",transclude:!0,bindToController:!0,controller:e,controllerAs:"cardController",templateUrl:"assets/views/bret-card.html"}})}(angular);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9jb21wb25lbnRzLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJFcnJvciIsImFwcCIsIm1vZHVsZSIsImNvbnN0YW50IiwiQm9tYlRhc2tDb250cm9sbGVyIiwiJHNjb3BlIiwiJGZpbHRlciIsIiRpbnRlcnZhbCIsIiRpbmplY3RvciIsInRoaXMiLCJfc3RvcmFnZUtleSIsImluaXQiLCIkaW5qZWN0IiwicHJvdG90eXBlIiwiX2luaXRJbnRlcm5hbHMiLCJfaW5pdFNldHRpbmdzIiwiX2luaXRXYXRjaGVzIiwiX2luaXRNYXRyaXgiLCJfaW5pdEJvbWIiLCJfaW5pdEZvcm0iLCJfZGVzaXN0IiwicmVzZXQiLCJfY29sbGVjdGlvblVud2F0Y2hGIiwiX2JvbWJVbndhdGNoRiIsIl9yZW1vdmVTdGF0ZSIsInN0YXJ0IiwiaW5kZXgiLCJkeW5hbWljIiwibWUiLCJtYXgiLCJpdGVyYXRvciIsImxlbmd0aCIsIl9pbnRJbmRleCIsIl9pbnRlcnZhbElkIiwiaXRlbSIsInVwZGF0ZSIsInN0b3AiLCJpbnRlcnZhbCIsInN0YXJ0ZWQiLCJfcGVyc2lzdCIsImNhbmNlbCIsImZlZWRiYWNrIiwicmVzb2x2ZWQiLCJzdG9wcGVkIiwicmVzb2x2ZSIsImkiLCJjb2xsZWN0aW9uIiwiJCRyZXNvbHZlZCIsImNvbHVtbiIsImFjdGl2ZSIsImluZGV4T2YiLCJwdXNoIiwiJCRhY3RpdmUiLCJzcGxpY2UiLCJpc0JvbWIiLCJlcXVhbHMiLCJib21iIiwiaGFzQm9tYiIsImZpbHRlcmVkIiwiZ2V0VG90YWxCb3hlcyIsInJvd3MiLCJjb2xzIiwiZ2V0Q29sbGVjdGVkQm94ZXMiLCJnZXRSZW1haW5pbmdCb3hlcyIsIl9nZXRDb25zdGFudCIsIm5hbWUiLCJoYXMiLCJnZXQiLCJfZ2V0Q29sdW1uIiwiZGF0YSIsInJvdyIsImNvbCIsIm1hdHJpeCIsIl9nZXRTdGF0ZSIsInNlc3Npb25TdG9yYWdlIiwiZnJvbUpzb24iLCJnZXRJdGVtIiwiX3NldFN0YXRlIiwic2V0SXRlbSIsInRvSnNvbiIsInJlbW92ZUl0ZW0iLCJzdGF0ZSIsIndpZHRoIiwiaGVpZ2h0IiwicmFuZG9tIiwidW5kb2FibGUiLCIkd2F0Y2hDb2xsZWN0aW9uIiwiZm9ybSIsImJveGVzX2NvbGxlY3RlZCIsImJveGVzX3NjaGVtZSIsIiR3YXRjaCIsImJvbWJfbG9jYXRpb24iLCJjb2x1bW5zIiwiaiIsIl9wdXNoUmFuZG9tIiwiX2dldFJhbmRvbSIsIm1pbiIsIk1hdGgiLCJmbG9vciIsImFycmF5IiwidmFsdWUiLCJyYW5kIiwiX3NodWZmbGVBcnJheSIsInRlbXAiLCJjb250cm9sbGVyIiwiQ2FyZENvbnRyb2xsZXIiLCJtb2RlbCIsImlzQWN0aXZlIiwiaXNEaXNhYmxlZCIsImlzQ2xpY2thYmxlIiwidG9nZ2xlIiwib25Ub2dnbGUiLCJkaXJlY3RpdmUiLCJzY29wZSIsInJlc3RyaWN0IiwidHJhbnNjbHVkZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJ0ZW1wbGF0ZVVybCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Q0FjQSxTQUFVQSxHQUtSLEdBQXVCLG1CQUFaQSxHQUNULEtBQU1DLE9BQU0sK0NBU2QsSUFBSUMsR0FBTUYsRUFBUUcsT0FBTyxjQUt6QkQsR0FBSUUsU0FBUyxtQkFBbUIsR0FDaENGLEVBQUlFLFNBQVMsbUJBQW1CLEdBQ2hDRixFQUFJRSxTQUFTLGdCQUFnQixRQUM3QkYsRUFBSUUsU0FBUyxpQkFBaUIsUUFDOUJGLEVBQUlFLFNBQVMsb0JBQW1CLEdBQ2hDRixFQUFJRSxTQUFTLG9CQUFtQixHQUNoQ0YsRUFBSUUsU0FBUyxrQkFBaUIsR0FDOUJGLEVBQUlFLFNBQVMsbUJBQWtCLEdBQy9CRixFQUFJRSxTQUFTLG1CQUFtQixFQVNoQyxJQUFJQyxHQUFxQixTQUFTQyxFQUFPQyxFQUFRQyxFQUFVQyxHQUV2REMsS0FBS0MsWUFBYyxhQUVuQkQsS0FBS0QsVUFBWUEsRUFDakJDLEtBQUtGLFVBQVlBLEVBQ2pCRSxLQUFLSCxRQUFVQSxFQUNmRyxLQUFL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RUFBT0osRUFBTXRELEVBRWZzRCxHQUFNdEQsR0FBS3NELEVBQU1FLEdBQ2pCRixFQUFNRSxHQUFRRSxFQUdsQixNQUFPSixJQUlibEcsRUFBSXVHLFdBQVcscUJBQXFCcEcsRUFTcEMsSUFBSXFHLEdBQWlCLFlBS3JCQSxHQUFlNUYsVUFBVTZGLE1BQVEsS0FTakNELEVBQWU1RixVQUFVOEYsVUFBVyxFQUtwQ0YsRUFBZTVGLFVBQVUrRixZQUFhLEVBS3RDSCxFQUFlNUYsVUFBVWdHLGFBQWMsRUFNdkNKLEVBQWU1RixVQUFVaUcsT0FBUyxZQUUxQnJHLEtBQUttRyxZQUFlbkcsS0FBS29HLGNBRzdCcEcsS0FBS2tHLFVBQVlsRyxLQUFLa0csU0FDdEJsRyxLQUFLc0csVUFBVUwsTUFBTWpHLEtBQUtpRyxNQUFNekIsTUFBTXhFLEtBQUtrRyxhQUkvQzFHLEVBQUkrRyxVQUFVLE9BQU8sV0FFbkIsT0FDRUMsT0FDRVAsTUFBTSxRQUNOSyxTQUFTLGdCQUNUSixTQUFTLGlCQUNUQyxXQUFXLG1CQUNYQyxZQUFZLHFCQUVkSyxTQUFVLElBQ1ZDLFlBQVksRUFDWkMsa0JBQWtCLEVBQ2xCWixXQUFZQyxFQUNaWSxhQUFjLGlCQUNkQyxZQUFhLGtDQU1oQnZIIiwiZmlsZSI6ImFwcC9jb21wb25lbnRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQk9NQiBSSVNLIEVMSUNJVEFUSU9OIFRBU0sgKEJSRVQpIEFQUFxuICpcbiAqIEBhdXRob3IgQXJtaW4gUGZ1cnRzY2hlbGxlclxuICogQGxpY2Vuc2UgTUlUXG4gKi9cbihmdW5jdGlvbihhbmd1bGFyKXtcblxuICAvL1xuICAvLyBBTkdVTEFSXG4gIC8vXG4gIGlmICh0eXBlb2YgYW5ndWxhciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB0aHJvdyBFcnJvcignQ2Fubm90IGluaXRpYWxpemUgYm9tYiB0YXNrIHdpdGhvdXQgYW5ndWxhciEnKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvL1xuICAvLyBNT0RVTEVcbiAgLy9cblxuICAvLyBpbml0aWFsaXplIGFuZ3VsYXIgbW9kdWxlIGZvciBhcHBcbiAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdib21iVGFzaycsW10pO1xuXG4gIC8vXG4gIC8vIENPTlNUQU5UU1xuICAvL1xuICBhcHAuY29uc3RhbnQoJ0RFRkFVTFRfTlVNX1JPV1MnLDUpO1xuICBhcHAuY29uc3RhbnQoJ0RFRkFVTFRfTlVNX0NPTFMnLDUpO1xuICBhcHAuY29uc3RhbnQoJ0RFRkFVTFRfV0lEVEgnLCc3NXB4Jyk7XG4gIGFwcC5jb25zdGFudCgnREVGQVVMVF9IRUlHSFQnLCc3NXB4Jyk7XG4gIGFwcC5jb25zdGFudCgnREVGQVVMVF9GRUVEQkFDSycsdHJ1ZSk7XG4gIGFwcC5jb25zdGFudCgnREVGQVVMVF9VTkRPQUJMRScsdHJ1ZSk7XG4gIGFwcC5jb25zdGFudCgnREVGQVVMVF9SQU5ET00nLGZhbHNlKTtcbiAgYXBwLmNvbnN0YW50KCdERUZBVUxUX0RZTkFNSUMnLGZhbHNlKTtcbiAgYXBwLmNvbnN0YW50KCdERUZBVUxUX0lOVEVSVkFMJywxKTtcblxuICAvL1xuICAvLyBDT05UUk9MTEVSXG4gIC8vXG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgdmFyIEJvbWJUYXNrQ29udHJvbGxlciA9IGZ1bmN0aW9uKCRzY29wZSwkZmlsdGVyLCRpbnRlcnZhbCwkaW5qZWN0b3IpXG4gICAge1xuICAgICAgdGhpcy5fc3RvcmFnZUtleSA9ICdicmV0X3N0YXRlJztcblxuICAgICAgdGhpcy4kaW5qZWN0b3IgPSAkaW5qZWN0b3I7XG4gICAgICB0aGlzLiRpbnRlcnZhbCA9ICRpbnRlcnZhbDtcbiAgICAgIHRoaXMuJGZpbHRlciA9ICRmaWx0ZXI7XG4gICAgICB0aGlzLiRzY29wZSA9ICRzY29wZTtcblxuICAgICAgdGhpcy5pbml0KCk7XG4gICAgfTtcblxuICAvKipcbiAgICogQHByb3BlcnR5IHtBcnJheS48U3RyaW5nPn0gJGluamVjdFxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsJyRmaWx0ZXInLCckaW50ZXJ2YWwnLCckaW5qZWN0b3InXTtcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgbWF0cml4IGFycmF5IGFuZCByYW5kb20gYm9tYi5cbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAvLyBpbml0IGludGVybmFsIG1lbWJlcnNcbiAgICAgIHRoaXMuX2luaXRJbnRlcm5hbHMoKTtcbiAgICAgIHRoaXMuX2luaXRTZXR0aW5ncygpO1xuICAgICAgdGhpcy5faW5pdFdhdGNoZXMoKTtcbiAgICAgIHRoaXMuX2luaXRNYXRyaXgoKTtcbiAgICAgIHRoaXMuX2luaXRCb21iKCk7XG4gICAgICB0aGlzLl9pbml0Rm9ybSgpO1xuXG4gICAgICAvLyByZXN0b3JlIHN0YXRlXG4gICAgICB0aGlzLl9kZXNpc3QoKTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBSZXNldHMgQlJFVCBmb3IgbmV3IHJvdW5kcy5cbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgLy8gdW5zZXQgd2F0Y2hlcyBhbmQgc3RvcmFnZVxuICAgICAgdGhpcy5fY29sbGVjdGlvblVud2F0Y2hGKCk7XG4gICAgICB0aGlzLl9ib21iVW53YXRjaEYoKTtcbiAgICAgIHRoaXMuX3JlbW92ZVN0YXRlKCk7XG5cbiAgICAgIC8vIHJlaW5pdGlhbGl6ZVxuICAgICAgdGhpcy5pbml0KCk7XG4gICAgfTtcblxuICAvKipcbiAgICogU3RhcnRzIGN1cnJlbnQgQlJFVCByb3VuZC5cbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbihpbmRleClcbiAgICB7XG4gICAgICAvLyBhdXRvbWF0aWNhbGx5IHJlc29sdmUgY2FyZHNcbiAgICAgIC8vIGJ5IGdpdmVuIHRpbWUgaW50ZXJ2YWwsIHNvXG4gICAgICAvLyBieSByYW5kb20gb3JkZXIgb3Igcm93c1xuICAgICAgaWYoIHRoaXMuZHluYW1pYyApXG4gICAgICB7XG4gICAgICAgIHZhciBtZSA9IHRoaXMsXG4gICAgICAgICAgbWF4ID0gdGhpcy5pdGVyYXRvci5sZW5ndGg7XG5cbiAgICAgICAgdGhpcy5faW50SW5kZXggPSBpbmRleCB8fCAwO1xuICAgICAgICB0aGlzLl9pbnRlcnZhbElkID0gbWUuJGludGVydmFsKFxuICAgICAgICAgIGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgIHZhciBpdGVtID0gbWUuaXRlcmF0b3JbbWUuX2ludEluZGV4XTtcbiAgICAgICAgICAgIG1lLnVwZGF0ZShpdGVtLHRydWUpO1xuXG4gICAgICAgICAgICBtZS5faW50SW5kZXgrKztcbiAgICAgICAgICAgIGlmKCBtZS5faW50SW5kZXg9PT1tYXggKVxuICAgICAgICAgICAgICBtZS5zdG9wKCk7XG5cbiAgICAgICAgICB9LFxuICAgICAgICAgIHRoaXMuaW50ZXJ2YWwqMTAwMCwgLy8gPSBmcm9tIHNlY29uZHNcbiAgICAgICAgICBtYXggLSB0aGlzLl9pbnRJbmRleCAvLyA9IG1heCBpdGVyYXRpb25zXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICB0aGlzLl9wZXJzaXN0KCk7XG4gICAgfTtcblxuICAvKipcbiAgICogU3RvcHMgY3VycmVudCBCUkVUIHJvdW5kLlxuICAgKiBAcmV0dXJuIHtWb2lkfVxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIGlmKCB0aGlzLmR5bmFtaWMgJiYgdGhpcy5faW50ZXJ2YWxJZCApXG4gICAgICAgIHRoaXMuJGludGVydmFsLmNhbmNlbCh0aGlzLl9pbnRlcnZhbElkKTtcblxuICAgICAgaWYoICF0aGlzLmZlZWRiYWNrICkgLy8gQHNlZTogdGVtcGxhdGUhXG4gICAgICAgIHRoaXMucmVzb2x2ZWQgPSB0cnVlO1xuXG4gICAgICB0aGlzLnN0b3BwZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fcGVyc2lzdCgpO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIFJldmVhbHMgYWxsIGNhcmRzIGluIGN1cnJlbnQgY29sbGVjdGlvbi5cbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUucmVzb2x2ZSA9IGZ1bmN0aW9uKClcbiAgICB7XG4gICAgICBmb3IoIHZhciBpPTA7IGk8dGhpcy5jb2xsZWN0aW9uLmxlbmd0aDsgaSsrIClcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uW2ldLiQkcmVzb2x2ZWQgPSB0cnVlO1xuXG4gICAgICB0aGlzLnJlc29sdmVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX3BlcnNpc3QoKTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGVzIGludGVybmFsIGNhcmRzIGNvbGxlY3Rpb24gc3RhY2suXG4gICAqL1xuICBCb21iVGFza0NvbnRyb2xsZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKGNvbHVtbixhY3RpdmUpXG4gICAge1xuICAgICAgdmFyIGluZGV4ID0gdGhpcy5jb2xsZWN0aW9uLmluZGV4T2YoY29sdW1uKTtcblxuICAgICAgaWYoIGFjdGl2ZSApXG4gICAgICB7XG4gICAgICAgIGlmKCBpbmRleDwwIClcbiAgICAgICAgICB0aGlzLmNvbGxlY3Rpb24ucHVzaChjb2x1bW4pO1xuXG4gICAgICAgIGNvbHVtbi4kJGFjdGl2ZSA9IHRydWU7XG4gICAgICB9XG4gICAgICBlbHNlXG4gICAgICB7XG4gICAgICAgIGlmKCBpbmRleD49MCApXG4gICAgICAgIHtcbiAgICAgICAgICB0aGlzLmNvbGxlY3Rpb24uc3BsaWNlKGluZGV4LDEpO1xuICAgICAgICAgIGNvbHVtbi4kJGFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX3BlcnNpc3QoKTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhpcyBjb2x1bW4gZXF1YWxzIGN1cnJlbnQgYm9tYi5cbiAgICogQHBhcmFtIHtPYmplY3R9IGNvbHVtbiBUaGUgY29sdW1uIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLnByb3RvdHlwZS5pc0JvbWIgPSBmdW5jdGlvbihjb2x1bW4pXG4gICAge1xuICAgICAgcmV0dXJuIGFuZ3VsYXIuZXF1YWxzKHRoaXMuYm9tYixjb2x1bW4pO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBib21iIGlzIGNvbnRhaW5lZCBpbiBjb2xsZWN0aW9uLlxuICAgKiBAcmV0dXJuIHtJbnRlZ2VyfVxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLnByb3RvdHlwZS5oYXNCb21iID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIHZhciBtZSA9IHRoaXMsXG4gICAgICAgIGZpbHRlcmVkID0gdGhpcy4kZmlsdGVyKCdmaWx0ZXInKShcbiAgICAgICAgICB0aGlzLmNvbGxlY3Rpb24sXG4gICAgICAgICAgZnVuY3Rpb24oY29sdW1uKVxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBtZS5pc0JvbWIoY29sdW1uKTtcbiAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgIHJldHVybiArKGZpbHRlcmVkLmxlbmd0aCA9PT0gMSk7XG4gICAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBudW1iZXIgb2YgdG90YWwgYm94ZXMuXG4gICAqIEByZXR1cm4ge0ludGVnZXJ9XG4gICAqL1xuICBCb21iVGFza0NvbnRyb2xsZXIucHJvdG90eXBlLmdldFRvdGFsQm94ZXMgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgcmV0dXJuIHRoaXMucm93cyAqIHRoaXMuY29scztcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIG51bWJlciBvZiBjb2xsZWN0ZWQgYm94ZXMuXG4gICAqIEByZXR1cm4ge0ludGVnZXJ9XG4gICAqL1xuICBCb21iVGFza0NvbnRyb2xsZXIucHJvdG90eXBlLmdldENvbGxlY3RlZEJveGVzID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbGxlY3Rpb24ubGVuZ3RoO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgbnVtYmVyIG9mIHJlbWFpbmluZyBib3hlcy5cbiAgICogQHJldHVybiB7SW50ZWdlcn1cbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0UmVtYWluaW5nQm94ZXMgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0VG90YWxCb3hlcygpIC0gdGhpcy5nZXRDb2xsZWN0ZWRCb3hlcygpO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuX2dldENvbnN0YW50ID0gZnVuY3Rpb24obmFtZSlcbiAgICB7XG4gICAgICBpZiggdGhpcy4kaW5qZWN0b3IuaGFzKG5hbWUpIClcbiAgICAgICAgcmV0dXJuIHRoaXMuJGluamVjdG9yLmdldChuYW1lKTtcblxuICAgICAgcmV0dXJuIHRoaXMuJGluamVjdG9yLmdldCgnREVGQVVMVF8nICsgbmFtZSk7XG4gICAgfTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLnByb3RvdHlwZS5fZ2V0Q29sdW1uID0gZnVuY3Rpb24oZGF0YSlcbiAgICB7XG4gICAgICAvLyBmb3IgZGF0YS1iaW5kaW5nIVxuICAgICAgdmFyIHJvdyA9IGRhdGEucm93LTEsXG4gICAgICAgIGNvbCA9IGRhdGEuY29sLTE7XG5cbiAgICAgIHJldHVybiB0aGlzLm1hdHJpeFtyb3ddW2NvbF07XG4gICAgfTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLnByb3RvdHlwZS5fZ2V0U3RhdGUgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgaWYoIHR5cGVvZiBzZXNzaW9uU3RvcmFnZSAhPT0gXCJ1bmRlZmluZWRcIiApXG4gICAgICAgIHJldHVybiBhbmd1bGFyLmZyb21Kc29uKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0odGhpcy5fc3RvcmFnZUtleSkpO1xuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBCb21iVGFza0NvbnRyb2xsZXIucHJvdG90eXBlLl9zZXRTdGF0ZSA9IGZ1bmN0aW9uKGRhdGEpXG4gICAge1xuICAgICAgaWYoIHR5cGVvZiBzZXNzaW9uU3RvcmFnZSAhPT0gXCJ1bmRlZmluZWRcIiApXG4gICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0odGhpcy5fc3RvcmFnZUtleSxhbmd1bGFyLnRvSnNvbihkYXRhKSk7XG4gICAgfTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLnByb3RvdHlwZS5fcmVtb3ZlU3RhdGUgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgaWYoIHR5cGVvZiBzZXNzaW9uU3RvcmFnZSAhPT0gXCJ1bmRlZmluZWRcIiApXG4gICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5fc3RvcmFnZUtleSk7XG4gICAgfTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLnByb3RvdHlwZS5fcGVyc2lzdCA9IGZ1bmN0aW9uKClcbiAgICB7XG4gICAgICB2YXIgc3RhdGUgPSB7XG4gICAgICAgIGJvbWI6IHRoaXMuYm9tYixcbiAgICAgICAgc3RhcnRlZDogdGhpcy5zdGFydGVkLFxuICAgICAgICBzdG9wcGVkOiB0aGlzLnN0b3BwZWQsXG4gICAgICAgIHJlc29sdmVkOiB0aGlzLnJlc29sdmVkLFxuICAgICAgICBjb2xsZWN0aW9uOiB0aGlzLmNvbGxlY3Rpb25cbiAgICAgIH07XG5cbiAgICAgIGlmKCB0aGlzLmR5bmFtaWMgKVxuICAgICAge1xuICAgICAgICBzdGF0ZS5pdGVyYXRvciA9IHRoaXMuaXRlcmF0b3I7XG4gICAgICAgIHN0YXRlLl9pbnRJbmRleCA9IHRoaXMuX2ludEluZGV4O1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9zZXRTdGF0ZShzdGF0ZSk7XG4gICAgfTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLnByb3RvdHlwZS5fZGVzaXN0ID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIHZhciBzdGF0ZSA9IHRoaXMuX2dldFN0YXRlKCk7XG4gICAgICBpZiggc3RhdGUgPT09IG51bGwgKVxuICAgICAgICByZXR1cm47XG5cbiAgICAgIHRoaXMuYm9tYiA9IHRoaXMuX2dldENvbHVtbihzdGF0ZS5ib21iKTtcblxuICAgICAgaWYoIHN0YXRlLml0ZXJhdG9yIClcbiAgICAgIHtcbiAgICAgICAgdGhpcy5pdGVyYXRvciA9IFtdO1xuICAgICAgICBmb3IoIHZhciBpPTA7aTxzdGF0ZS5pdGVyYXRvci5sZW5ndGg7aSsrIClcbiAgICAgICAge1xuICAgICAgICAgIHZhciBjb2x1bW4gPSB0aGlzLl9nZXRDb2x1bW4oXG4gICAgICAgICAgICBzdGF0ZS5pdGVyYXRvcltpXVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICB0aGlzLml0ZXJhdG9yLnB1c2goY29sdW1uKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmb3IoIHZhciBpPTA7aTxzdGF0ZS5jb2xsZWN0aW9uLmxlbmd0aDtpKysgKVxuICAgICAge1xuICAgICAgICB2YXIgY29sdW1uID0gdGhpcy5fZ2V0Q29sdW1uKFxuICAgICAgICAgIHN0YXRlLmNvbGxlY3Rpb25baV1cbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZShjb2x1bW4sdHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIGlmKCBzdGF0ZS5zdGFydGVkIClcbiAgICAgICAgdGhpcy5zdGFydChzdGF0ZS5faW50SW5kZXgpO1xuXG4gICAgICBpZiggc3RhdGUuc3RvcHBlZCApXG4gICAgICAgIHRoaXMuc3RvcCgpO1xuXG4gICAgICBpZiggc3RhdGUucmVzb2x2ZWQgKVxuICAgICAgICB0aGlzLnJlc29sdmUoKTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBCb21iVGFza0NvbnRyb2xsZXIucHJvdG90eXBlLl9pbml0U2V0dGluZ3MgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgdGhpcy53aWR0aCA9IHRoaXMuX2dldENvbnN0YW50KCdXSURUSCcpO1xuICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLl9nZXRDb25zdGFudCgnSEVJR0hUJyk7XG5cbiAgICAgIHRoaXMucm93cyA9IHRoaXMuX2dldENvbnN0YW50KCdOVU1fUk9XUycpO1xuICAgICAgdGhpcy5jb2xzID0gdGhpcy5fZ2V0Q29uc3RhbnQoJ05VTV9DT0xTJyk7XG5cbiAgICAgIHRoaXMucmFuZG9tID0gdGhpcy5fZ2V0Q29uc3RhbnQoJ1JBTkRPTScpO1xuICAgICAgdGhpcy5keW5hbWljID0gdGhpcy5fZ2V0Q29uc3RhbnQoJ0RZTkFNSUMnKTtcbiAgICAgIHRoaXMuaW50ZXJ2YWwgPSB0aGlzLl9nZXRDb25zdGFudCgnSU5URVJWQUwnKTtcblxuICAgICAgdGhpcy5mZWVkYmFjayA9IHRoaXMuX2dldENvbnN0YW50KCdGRUVEQkFDSycpO1xuICAgICAgdGhpcy51bmRvYWJsZSA9IHRoaXMuX2dldENvbnN0YW50KCdVTkRPQUJMRScpO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuX2luaXRJbnRlcm5hbHMgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgdGhpcy5jb2xsZWN0aW9uID0gW107XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuc3RvcHBlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5yZXNvbHZlZCA9IGZhbHNlO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuX2luaXRXYXRjaGVzID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICB0aGlzLl9jb2xsZWN0aW9uVW53YXRjaEYgPSB0aGlzLiRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKFxuICAgICAgICBmdW5jdGlvbigpeyByZXR1cm4gbWUuY29sbGVjdGlvbjsgfSxcbiAgICAgICAgZnVuY3Rpb24oY29sbGVjdGlvbil7XG4gICAgICAgICAgbWUuZm9ybS5ib3hlc19jb2xsZWN0ZWQgPSBjb2xsZWN0aW9uLmxlbmd0aDtcbiAgICAgICAgICBtZS5mb3JtLmJveGVzX3NjaGVtZSA9IGFuZ3VsYXIudG9Kc29uKGNvbGxlY3Rpb24pO1xuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgICB0aGlzLl9ib21iVW53YXRjaEYgPSB0aGlzLiRzY29wZS4kd2F0Y2goXG4gICAgICAgIGZ1bmN0aW9uKCl7IHJldHVybiBtZS5oYXNCb21iKCk7IH0sXG4gICAgICAgIGZ1bmN0aW9uKGhhc0JvbWIpe1xuICAgICAgICAgIG1lLmZvcm0uYm9tYiA9IGhhc0JvbWI7XG4gICAgICAgICAgbWUuZm9ybS5ib21iX2xvY2F0aW9uID0gYW5ndWxhci50b0pzb24obWUuYm9tYik7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQm9tYlRhc2tDb250cm9sbGVyLnByb3RvdHlwZS5faW5pdE1hdHJpeCA9IGZ1bmN0aW9uKClcbiAgICB7XG4gICAgICB0aGlzLm1hdHJpeCA9IFtdO1xuICAgICAgdGhpcy5pdGVyYXRvciA9IFtdO1xuXG4gICAgICBmb3IoIHZhciBpPTA7IGk8dGhpcy5yb3dzOyBpKysgKVxuICAgICAge1xuICAgICAgICB2YXIgY29sdW1ucyA9IFtdO1xuICAgICAgICBmb3IoIHZhciBqPTA7IGo8dGhpcy5jb2xzOyBqKysgKVxuICAgICAgICB7XG4gICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICByb3c6IGkrMSxcbiAgICAgICAgICAgIGNvbDogaisxXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNvbHVtbnMucHVzaChkYXRhKTtcblxuICAgICAgICAgIGlmKCB0aGlzLmR5bmFtaWMgKVxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlmKCAhdGhpcy5yYW5kb20gKVxuICAgICAgICAgICAgICB0aGlzLml0ZXJhdG9yLnB1c2goZGF0YSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgIHRoaXMuX3B1c2hSYW5kb20odGhpcy5pdGVyYXRvcixkYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm1hdHJpeC5wdXNoKGNvbHVtbnMpO1xuICAgICAgfVxuICAgIH07XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuX2luaXRCb21iID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIHZhciByb3cgPSB0aGlzLl9nZXRSYW5kb20oMCx0aGlzLnJvd3MtMSksXG4gICAgICAgIGNvbCA9IHRoaXMuX2dldFJhbmRvbSgwLHRoaXMuY29scy0xKTtcblxuICAgICAgdGhpcy5ib21iID0gdGhpcy5tYXRyaXhbcm93XVtjb2xdO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuX2luaXRGb3JtID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIHRoaXMuZm9ybSA9IHtcbiAgICAgICAgYm9tYjogMCxcbiAgICAgICAgYm94ZXNfc2NoZW1lOiBbXSxcbiAgICAgICAgYm94ZXNfY29sbGVjdGVkOiAwLFxuICAgICAgICBib21iX2xvY2F0aW9uOiBudWxsXG4gICAgICB9O1xuICAgIH07XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuX2dldFJhbmRvbSA9IGZ1bmN0aW9uKG1pbixtYXgpXG4gICAge1xuICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXgtbWluKzEpICsgbWluKTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBCb21iVGFza0NvbnRyb2xsZXIucHJvdG90eXBlLl9wdXNoUmFuZG9tID0gZnVuY3Rpb24oYXJyYXksdmFsdWUpXG4gICAge1xuICAgICAgLy8gSW5zaWRlLU91dCBTaHVmZmxlIEFsZ29yaXRobVxuICAgICAgdmFyIHJhbmQgPSB0aGlzLl9nZXRSYW5kb20oMCxhcnJheS5sZW5ndGgpO1xuICAgICAgYXJyYXkucHVzaChhcnJheVtyYW5kXSk7XG4gICAgICBhcnJheVtyYW5kXSA9IHZhbHVlO1xuXG4gICAgICByZXR1cm4gYXJyYXkubGVuZ3RoO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEJvbWJUYXNrQ29udHJvbGxlci5wcm90b3R5cGUuX3NodWZmbGVBcnJheSA9IGZ1bmN0aW9uKGFycmF5KVxuICAgIHtcbiAgICAgIC8vIEZpc2hlci1ZYXRlcyBTaHVmZmxlIEFsZ29yaXRobVxuICAgICAgZm9yKCB2YXIgaT1hcnJheS5sZW5ndGgtMTsgaT4wOyBpLS0gKVxuICAgICAge1xuICAgICAgICB2YXIgcmFuZCA9IHRoaXMuX2dldFJhbmRvbSgwLGkpLFxuICAgICAgICAgICAgICB0ZW1wID0gYXJyYXlbaV07XG5cbiAgICAgICAgICAgIGFycmF5W2ldID0gYXJyYXlbcmFuZF07XG4gICAgICAgICAgICBhcnJheVtyYW5kXSA9IHRlbXA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgfTtcblxuICAvLyByZWdpc3RlciB0aGUgY29udHJvbGxlciBmb3IgYXBwXG4gIGFwcC5jb250cm9sbGVyKCdCb21iVGFza0NvbnRyb2xsZXInLEJvbWJUYXNrQ29udHJvbGxlcik7XG5cbiAgLy9cbiAgLy8gQ09NUE9ORU5UXG4gIC8vXG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgdmFyIENhcmRDb250cm9sbGVyID0gZnVuY3Rpb24oKXt9O1xuXG4gIC8qKlxuICAgKiBAdmFyIHtPYmpldH0gbW9kZWwgQ2FyZCdzIG1vZGVsIHRvIHdyaXRlLlxuICAgKi9cbiAgQ2FyZENvbnRyb2xsZXIucHJvdG90eXBlLm1vZGVsID0gbnVsbDtcblxuICAvKipcbiAgICpcblxuXG4gIC8qKlxuICAgKiBAdmFyIHtCb29sZWFufSBpc0FjdGl2ZSBDdXJyZW50IGFjdGl2aXR5IHN0YXRlLlxuICAgKi9cbiAgQ2FyZENvbnRyb2xsZXIucHJvdG90eXBlLmlzQWN0aXZlID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIEB2YXIge0Jvb2xlYW59IGlzRGlzYWJsZWQgQ3VycmVudCBkaXNhYmxlZCBzdGF0ZS5cbiAgICovXG4gIENhcmRDb250cm9sbGVyLnByb3RvdHlwZS5pc0Rpc2FibGVkID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIEB2YXIge0Jvb2xlYW59IGlzQ2xpY2thYmxlIENhcmRzIGNsaWNrYWJpbGl0eS5cbiAgICovXG4gIENhcmRDb250cm9sbGVyLnByb3RvdHlwZS5pc0NsaWNrYWJsZSA9IHRydWU7XG5cbiAgLyoqXG4gICAqIFRvZ2dsZXMgY2FyZCdzIGN1cnJlbnQgYWN0aXZpdHkgc3RhdGUuXG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICBDYXJkQ29udHJvbGxlci5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIGlmKCB0aGlzLmlzRGlzYWJsZWQgfHwgIXRoaXMuaXNDbGlja2FibGUgKVxuICAgICAgICByZXR1cm47XG5cbiAgICAgIHRoaXMuaXNBY3RpdmUgPSAhdGhpcy5pc0FjdGl2ZTtcbiAgICAgIHRoaXMub25Ub2dnbGUoe21vZGVsOnRoaXMubW9kZWwsc3RhdGU6dGhpcy5pc0FjdGl2ZX0pO1xuICAgIH07XG5cbiAgLy8gcmVnaXN0ZXIgdGhlIGNvbnRyb2xsZXIgZm9yIGFwcFxuICBhcHAuZGlyZWN0aXZlKCdjYXJkJyxmdW5jdGlvbigpe1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIG1vZGVsOic9Y2FyZCcsXG4gICAgICAgIG9uVG9nZ2xlOicmY2FyZE9uVG9nZ2xlJyxcbiAgICAgICAgaXNBY3RpdmU6Jz0/Y2FyZElzQWN0aXZlJyxcbiAgICAgICAgaXNEaXNhYmxlZDonPT9jYXJkSXNEaXNhYmxlZCcsXG4gICAgICAgIGlzQ2xpY2thYmxlOic9P2NhcmRJc0NsaWNrYWJsZSdcbiAgICAgIH0sXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBDYXJkQ29udHJvbGxlcixcbiAgICAgIGNvbnRyb2xsZXJBczogJ2NhcmRDb250cm9sbGVyJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnYXNzZXRzL3ZpZXdzL2JyZXQtY2FyZC5odG1sJ1xuICAgIH07XG5cbiAgfSk7XG5cblxufSkoYW5ndWxhcik7XG4iXX0=
