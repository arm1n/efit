/*!
 * eFit Website
 * An app for financial training in educational environments
 * http://www.e-fit.com
 * @author Armin Pfurtscheller
 * @version 1.0.0
 * Copyright 2017. MIT licensed.
 */
/* global ANGULAR_MODULE, angular */
(function(module, angular) {
  'use strict';

  // --------------------------------------------------
  // Status
  // --------------------------------------------------

  //
  // CONTROLLER
  //

  /**
   * @constructor
   */
  var Status = function($scope, $attrs, $element) {
    this.$scope = $scope;
    this.$attrs = $attrs;
    this.$element = $element;

    this.iconRatio = 1;
    this.isCompact = false;
    this.iconColor = 'currentcolor';
  };

  Status.$inject = ['$scope', '$element', '$attrs'];

  //
  // REGISTRY
  //
  angular.module(module).directive('status', function(){
    return {
      scope: {
        iconRatio:'=?statusIconRatio',
        iconColor:'=?statusIconColor',
        isCompact:'=?statusIsCompact'
      },
      restrict: 'A',
      transclude: true,
      controller: Status,
      bindToController: true,
      controllerAs: 'statusController',
      templateUrl: 'views/directives/status.html'
    };
  });

  // --------------------------------------------------
  // Status Icons
  // --------------------------------------------------

  //
  // CONTROLLER
  //

  /**
   * @constructor
   */
  var StatusIcons = function($scope, $attrs, $element, $injector) {
    this.$scope = $scope;
    this.$attrs = $attrs;
    this.$element = $element;
    this.$injector = $injector;

    this.ratio = 1;
    this.color = 'currentcolor';
  };

  StatusIcons.$inject = ['$scope', '$attrs', '$element', '$injector'];

  /** @var {boolean} isBeginner If user has state `STATE_BEGINNER` or higher. */
  StatusIcons.prototype.isBeginner = false;

  /** @var {boolean} isAmateuer If user has state `STATE_AMATEUR` or higher. */
  StatusIcons.prototype.isAmateuer = false;

  /** @var {boolean} isAdvanced If user has state `STATE_ADVANCED` or higher. */
  StatusIcons.prototype.isAdvanced = false;

  /** @var {boolean} isExpert If user has state `STATE_EXPERT` or higher. */
  StatusIcons.prototype.isExpert = false;

  /** @var {boolean} isProfi If user has state `STATE_PROFI` or higher. */
  StatusIcons.prototype.isProfi = false;

  //
  // METHODS
  //

  /**
   * Watches user's `state` property and maps them for view.
   *
   * @public
   * @method $onInit
   * @return {Void}
   */
  StatusIcons.prototype.$onInit = function()
    {
      var STATE_BEGINNER = this.$injector.get('STATE_BEGINNER');
      var STATE_AMATEUR = this.$injector.get('STATE_AMATEUR');
      var STATE_ADVANCED = this.$injector.get('STATE_ADVANCED');
      var STATE_EXPERT = this.$injector.get('STATE_EXPERT');
      var user = this.$injector.get('user');

      var me = this;

      var _watchExpression = function(){
        return user.state;
      };

      var _watchCallback = function(state) {
        me.isBeginner = state >= STATE_BEGINNER;
        me.isAmateur = state >= STATE_AMATEUR;
        me.isAdvanced = state >= STATE_ADVANCED;
        me.isExpert = state >= STATE_EXPERT;
      };

      this._unwatch = this.$scope.$watch(
        _watchExpression,
        _watchCallback
      );
    };

  /**
   * Removes event listener and watches.
   *
   * @public
   * @method $onDestroy
   * @return {void}
   */
  StatusIcons.prototype.$onDestroy = function() {
    this._unwatch();
  };

  //
  // REGISTRY
  //
  angular.module(module).directive('statusIcons', function() {
    return {
      scope: {
        ratio:'=?statusIconsRatio',
        color:'=?statusIconsColor',
      },
      restrict: 'A',
      transclude: true,
      controller: StatusIcons,
      bindToController: true,
      controllerAs: 'statusIconsController',
      templateUrl: 'views/directives/status-icons.html'
    };
  });

  // --------------------------------------------------
  // Status Label
  // --------------------------------------------------

  //
  // CONTROLLER
  //

  /**
   * @constructor
   */
  var StatusLabel = function($scope, $attrs, $element, $injector) {
    this.$scope = $scope;
    this.$attrs = $attrs;
    this.$element = $element;
    this.$injector = $injector;
  };

  StatusLabel.$inject = ['$scope', '$attrs', '$element', '$injector'];

  //
  // PROPERTIES
  //

  /** @var {string} state String represenation of user's `state`. */
  StatusLabel.prototype.state = null;

  //
  // METHODS
  //

  /**
   * Watches user's `state` property and maps them for view.
   *
   * @public
   * @method $onInit
   * @return {Void}
   */
  StatusLabel.prototype.$onInit = function()
    {
      var user = this.$injector.get('user');

      var me = this;

      var _watchExpression = function() {
        return user.state;
      };

      var _watchCallback = function() {
        me.state = user.getStateAsString();
      };

      this._unwatch = this.$scope.$watch(
        _watchExpression,
        _watchCallback
      );
    };

  /**
   * Removes event listener and watches.
   *
   * @public
   * @method $onDestroy
   * @return {void}
   */
  StatusLabel.prototype.$onDestroy = function() {
    this._unwatch();
  };

  //
  // REGISTRY
  //
  angular.module(module).directive('statusLabel', function(){
    return {
      scope: {},
      restrict: 'A',
      transclude: true,
      controller: StatusLabel,
      bindToController: true,
      controllerAs: 'statusLabelController',
      templateUrl: 'views/directives/status-label.html'
    };
  });

  // --------------------------------------------------
  // Status Label
  // --------------------------------------------------

  //
  // CONTROLLER
  //

  /**
   * @constructor
   */
  var StatusTickets = function($scope, $attrs, $element, $injector) {
    this.$scope = $scope;
    this.$attrs = $attrs;
    this.$element = $element;
    this.$injector = $injector;
  };

  StatusTickets.$inject = ['$scope', '$attrs', '$element', '$injector'];

  //
  // PROPERTIES
  //

  /** @var {number} tickets Current user ticket count. */
  StatusTickets.prototype.tickets = 0;

  //
  // METHODS
  //

  /**
   * Watches user's `state` property and maps them for view.
   *
   * @public
   * @method $onInit
   * @return {Void}
   */
  StatusTickets.prototype.$onInit = function()
    {
      var user = this.$injector.get('user');

      var me = this;

      var _watchExpression = function() {
        return user.tickets;
      };

      var _watchCallback = function(tickets) {
        me.tickets = tickets;
      };

      this._unwatch = this.$scope.$watch(
        _watchExpression,
        _watchCallback
      );
    };

  /**
   * Removes event listener and watches.
   *
   * @public
   * @method $onDestroy
   * @return {void}
   */
  StatusTickets.prototype.$onDestroy = function() {
    this._unwatch();
  };

  //
  // REGISTRY
  //
  angular.module(module).directive('statusTickets', function(){
    return {
      scope: {},
      restrict: 'A',
      transclude: true,
      controller: StatusTickets,
      bindToController: true,
      controllerAs: 'statusTicketsController',
      templateUrl: 'views/directives/status-tickets.html'
    };
  });

})(ANGULAR_MODULE, angular);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9kaXJlY3RpdmVzL3N0YXR1cy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAvZGlyZWN0aXZlcy9zdGF0dXMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIEFOR1VMQVJfTU9EVUxFLCBhbmd1bGFyICovXG4oZnVuY3Rpb24obW9kdWxlLCBhbmd1bGFyKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBTdGF0dXNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvL1xuICAvLyBDT05UUk9MTEVSXG4gIC8vXG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgdmFyIFN0YXR1cyA9IGZ1bmN0aW9uKCRzY29wZSwgJGF0dHJzLCAkZWxlbWVudCkge1xuICAgIHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuICAgIHRoaXMuJGF0dHJzID0gJGF0dHJzO1xuICAgIHRoaXMuJGVsZW1lbnQgPSAkZWxlbWVudDtcblxuICAgIHRoaXMuaWNvblJhdGlvID0gMTtcbiAgICB0aGlzLmlzQ29tcGFjdCA9IGZhbHNlO1xuICAgIHRoaXMuaWNvbkNvbG9yID0gJ2N1cnJlbnRjb2xvcic7XG4gIH07XG5cbiAgU3RhdHVzLiRpbmplY3QgPSBbJyRzY29wZScsICckZWxlbWVudCcsICckYXR0cnMnXTtcblxuICAvL1xuICAvLyBSRUdJU1RSWVxuICAvL1xuICBhbmd1bGFyLm1vZHVsZShtb2R1bGUpLmRpcmVjdGl2ZSgnc3RhdHVzJywgZnVuY3Rpb24oKXtcbiAgICByZXR1cm4ge1xuICAgICAgc2NvcGU6IHtcbiAgICAgICAgaWNvblJhdGlvOic9P3N0YXR1c0ljb25SYXRpbycsXG4gICAgICAgIGljb25Db2xvcjonPT9zdGF0dXNJY29uQ29sb3InLFxuICAgICAgICBpc0NvbXBhY3Q6Jz0/c3RhdHVzSXNDb21wYWN0J1xuICAgICAgfSxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogU3RhdHVzLFxuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXJBczogJ3N0YXR1c0NvbnRyb2xsZXInLFxuICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9kaXJlY3RpdmVzL3N0YXR1cy5odG1sJ1xuICAgIH07XG4gIH0pO1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIFN0YXR1cyBJY29uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vXG4gIC8vIENPTlRST0xMRVJcbiAgLy9cblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICB2YXIgU3RhdHVzSWNvbnMgPSBmdW5jdGlvbigkc2NvcGUsICRhdHRycywgJGVsZW1lbnQsICRpbmplY3Rvcikge1xuICAgIHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuICAgIHRoaXMuJGF0dHJzID0gJGF0dHJzO1xuICAgIHRoaXMuJGVsZW1lbnQgPSAkZWxlbWVudDtcbiAgICB0aGlzLiRpbmplY3RvciA9ICRpbmplY3RvcjtcblxuICAgIHRoaXMucmF0aW8gPSAxO1xuICAgIHRoaXMuY29sb3IgPSAnY3VycmVudGNvbG9yJztcbiAgfTtcblxuICBTdGF0dXNJY29ucy4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJGF0dHJzJywgJyRlbGVtZW50JywgJyRpbmplY3RvciddO1xuXG4gIC8qKiBAdmFyIHtib29sZWFufSBpc0JlZ2lubmVyIElmIHVzZXIgaGFzIHN0YXRlIGBTVEFURV9CRUdJTk5FUmAgb3IgaGlnaGVyLiAqL1xuICBTdGF0dXNJY29ucy5wcm90b3R5cGUuaXNCZWdpbm5lciA9IGZhbHNlO1xuXG4gIC8qKiBAdmFyIHtib29sZWFufSBpc0FtYXRldWVyIElmIHVzZXIgaGFzIHN0YXRlIGBTVEFURV9BTUFURVVSYCBvciBoaWdoZXIuICovXG4gIFN0YXR1c0ljb25zLnByb3RvdHlwZS5pc0FtYXRldWVyID0gZmFsc2U7XG5cbiAgLyoqIEB2YXIge2Jvb2xlYW59IGlzQWR2YW5jZWQgSWYgdXNlciBoYXMgc3RhdGUgYFNUQVRFX0FEVkFOQ0VEYCBvciBoaWdoZXIuICovXG4gIFN0YXR1c0ljb25zLnByb3RvdHlwZS5pc0FkdmFuY2VkID0gZmFsc2U7XG5cbiAgLyoqIEB2YXIge2Jvb2xlYW59IGlzRXhwZXJ0IElmIHVzZXIgaGFzIHN0YXRlIGBTVEFURV9FWFBFUlRgIG9yIGhpZ2hlci4gKi9cbiAgU3RhdHVzSWNvbnMucHJvdG90eXBlLmlzRXhwZXJ0ID0gZmFsc2U7XG5cbiAgLyoqIEB2YXIge2Jvb2xlYW59IGlzUHJvZmkgSWYgdXNlciBoYXMgc3RhdGUgYFNUQVRFX1BST0ZJYCBvciBoaWdoZXIuICovXG4gIFN0YXR1c0ljb25zLnByb3RvdHlwZS5pc1Byb2ZpID0gZmFsc2U7XG5cbiAgLy9cbiAgLy8gTUVUSE9EU1xuICAvL1xuXG4gIC8qKlxuICAgKiBXYXRjaGVzIHVzZXIncyBgc3RhdGVgIHByb3BlcnR5IGFuZCBtYXBzIHRoZW0gZm9yIHZpZXcuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCAkb25Jbml0XG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICBTdGF0dXNJY29ucy5wcm90b3R5cGUuJG9uSW5pdCA9IGZ1bmN0aW9uKClcbiAgICB7XG4gICAgICB2YXIgU1RBVEVfQkVHSU5ORVIgPSB0aGlzLiRpbmplY3Rvci5nZXQoJ1NUQVRFX0JFR0lOTkVSJyk7XG4gICAgICB2YXIgU1RBVEVfQU1BVEVVUiA9IHRoaXMuJGluamVjdG9yLmdldCgnU1RBVEVfQU1BVEVVUicpO1xuICAgICAgdmFyIFNUQVRFX0FEVkFOQ0VEID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCdTVEFURV9BRFZBTkNFRCcpO1xuICAgICAgdmFyIFNUQVRFX0VYUEVSVCA9IHRoaXMuJGluamVjdG9yLmdldCgnU1RBVEVfRVhQRVJUJyk7XG4gICAgICB2YXIgdXNlciA9IHRoaXMuJGluamVjdG9yLmdldCgndXNlcicpO1xuXG4gICAgICB2YXIgbWUgPSB0aGlzO1xuXG4gICAgICB2YXIgX3dhdGNoRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiB1c2VyLnN0YXRlO1xuICAgICAgfTtcblxuICAgICAgdmFyIF93YXRjaENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgbWUuaXNCZWdpbm5lciA9IHN0YXRlID49IFNUQVRFX0JFR0lOTkVSO1xuICAgICAgICBtZS5pc0FtYXRldXIgPSBzdGF0ZSA+PSBTVEFURV9BTUFURVVSO1xuICAgICAgICBtZS5pc0FkdmFuY2VkID0gc3RhdGUgPj0gU1RBVEVfQURWQU5DRUQ7XG4gICAgICAgIG1lLmlzRXhwZXJ0ID0gc3RhdGUgPj0gU1RBVEVfRVhQRVJUO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5fdW53YXRjaCA9IHRoaXMuJHNjb3BlLiR3YXRjaChcbiAgICAgICAgX3dhdGNoRXhwcmVzc2lvbixcbiAgICAgICAgX3dhdGNoQ2FsbGJhY2tcbiAgICAgICk7XG4gICAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlcyBldmVudCBsaXN0ZW5lciBhbmQgd2F0Y2hlcy5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kICRvbkRlc3Ryb3lcbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIFN0YXR1c0ljb25zLnByb3RvdHlwZS4kb25EZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fdW53YXRjaCgpO1xuICB9O1xuXG4gIC8vXG4gIC8vIFJFR0lTVFJZXG4gIC8vXG4gIGFuZ3VsYXIubW9kdWxlKG1vZHVsZSkuZGlyZWN0aXZlKCdzdGF0dXNJY29ucycsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBzY29wZToge1xuICAgICAgICByYXRpbzonPT9zdGF0dXNJY29uc1JhdGlvJyxcbiAgICAgICAgY29sb3I6Jz0/c3RhdHVzSWNvbnNDb2xvcicsXG4gICAgICB9LFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBTdGF0dXNJY29ucyxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyQXM6ICdzdGF0dXNJY29uc0NvbnRyb2xsZXInLFxuICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9kaXJlY3RpdmVzL3N0YXR1cy1pY29ucy5odG1sJ1xuICAgIH07XG4gIH0pO1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIFN0YXR1cyBMYWJlbFxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vXG4gIC8vIENPTlRST0xMRVJcbiAgLy9cblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICB2YXIgU3RhdHVzTGFiZWwgPSBmdW5jdGlvbigkc2NvcGUsICRhdHRycywgJGVsZW1lbnQsICRpbmplY3Rvcikge1xuICAgIHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuICAgIHRoaXMuJGF0dHJzID0gJGF0dHJzO1xuICAgIHRoaXMuJGVsZW1lbnQgPSAkZWxlbWVudDtcbiAgICB0aGlzLiRpbmplY3RvciA9ICRpbmplY3RvcjtcbiAgfTtcblxuICBTdGF0dXNMYWJlbC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJGF0dHJzJywgJyRlbGVtZW50JywgJyRpbmplY3RvciddO1xuXG4gIC8vXG4gIC8vIFBST1BFUlRJRVNcbiAgLy9cblxuICAvKiogQHZhciB7c3RyaW5nfSBzdGF0ZSBTdHJpbmcgcmVwcmVzZW5hdGlvbiBvZiB1c2VyJ3MgYHN0YXRlYC4gKi9cbiAgU3RhdHVzTGFiZWwucHJvdG90eXBlLnN0YXRlID0gbnVsbDtcblxuICAvL1xuICAvLyBNRVRIT0RTXG4gIC8vXG5cbiAgLyoqXG4gICAqIFdhdGNoZXMgdXNlcidzIGBzdGF0ZWAgcHJvcGVydHkgYW5kIG1hcHMgdGhlbSBmb3Igdmlldy5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kICRvbkluaXRcbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIFN0YXR1c0xhYmVsLnByb3RvdHlwZS4kb25Jbml0ID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgIHZhciB1c2VyID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCd1c2VyJyk7XG5cbiAgICAgIHZhciBtZSA9IHRoaXM7XG5cbiAgICAgIHZhciBfd2F0Y2hFeHByZXNzaW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB1c2VyLnN0YXRlO1xuICAgICAgfTtcblxuICAgICAgdmFyIF93YXRjaENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIG1lLnN0YXRlID0gdXNlci5nZXRTdGF0ZUFzU3RyaW5nKCk7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLl91bndhdGNoID0gdGhpcy4kc2NvcGUuJHdhdGNoKFxuICAgICAgICBfd2F0Y2hFeHByZXNzaW9uLFxuICAgICAgICBfd2F0Y2hDYWxsYmFja1xuICAgICAgKTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGV2ZW50IGxpc3RlbmVyIGFuZCB3YXRjaGVzLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgJG9uRGVzdHJveVxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgU3RhdHVzTGFiZWwucHJvdG90eXBlLiRvbkRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl91bndhdGNoKCk7XG4gIH07XG5cbiAgLy9cbiAgLy8gUkVHSVNUUllcbiAgLy9cbiAgYW5ndWxhci5tb2R1bGUobW9kdWxlKS5kaXJlY3RpdmUoJ3N0YXR1c0xhYmVsJywgZnVuY3Rpb24oKXtcbiAgICByZXR1cm4ge1xuICAgICAgc2NvcGU6IHt9LFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBTdGF0dXNMYWJlbCxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyQXM6ICdzdGF0dXNMYWJlbENvbnRyb2xsZXInLFxuICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9kaXJlY3RpdmVzL3N0YXR1cy1sYWJlbC5odG1sJ1xuICAgIH07XG4gIH0pO1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIFN0YXR1cyBMYWJlbFxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vXG4gIC8vIENPTlRST0xMRVJcbiAgLy9cblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICB2YXIgU3RhdHVzVGlja2V0cyA9IGZ1bmN0aW9uKCRzY29wZSwgJGF0dHJzLCAkZWxlbWVudCwgJGluamVjdG9yKSB7XG4gICAgdGhpcy4kc2NvcGUgPSAkc2NvcGU7XG4gICAgdGhpcy4kYXR0cnMgPSAkYXR0cnM7XG4gICAgdGhpcy4kZWxlbWVudCA9ICRlbGVtZW50O1xuICAgIHRoaXMuJGluamVjdG9yID0gJGluamVjdG9yO1xuICB9O1xuXG4gIFN0YXR1c1RpY2tldHMuJGluamVjdCA9IFsnJHNjb3BlJywgJyRhdHRycycsICckZWxlbWVudCcsICckaW5qZWN0b3InXTtcblxuICAvL1xuICAvLyBQUk9QRVJUSUVTXG4gIC8vXG5cbiAgLyoqIEB2YXIge251bWJlcn0gdGlja2V0cyBDdXJyZW50IHVzZXIgdGlja2V0IGNvdW50LiAqL1xuICBTdGF0dXNUaWNrZXRzLnByb3RvdHlwZS50aWNrZXRzID0gMDtcblxuICAvL1xuICAvLyBNRVRIT0RTXG4gIC8vXG5cbiAgLyoqXG4gICAqIFdhdGNoZXMgdXNlcidzIGBzdGF0ZWAgcHJvcGVydHkgYW5kIG1hcHMgdGhlbSBmb3Igdmlldy5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kICRvbkluaXRcbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIFN0YXR1c1RpY2tldHMucHJvdG90eXBlLiRvbkluaXQgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgdmFyIHVzZXIgPSB0aGlzLiRpbmplY3Rvci5nZXQoJ3VzZXInKTtcblxuICAgICAgdmFyIG1lID0gdGhpcztcblxuICAgICAgdmFyIF93YXRjaEV4cHJlc3Npb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHVzZXIudGlja2V0cztcbiAgICAgIH07XG5cbiAgICAgIHZhciBfd2F0Y2hDYWxsYmFjayA9IGZ1bmN0aW9uKHRpY2tldHMpIHtcbiAgICAgICAgbWUudGlja2V0cyA9IHRpY2tldHM7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLl91bndhdGNoID0gdGhpcy4kc2NvcGUuJHdhdGNoKFxuICAgICAgICBfd2F0Y2hFeHByZXNzaW9uLFxuICAgICAgICBfd2F0Y2hDYWxsYmFja1xuICAgICAgKTtcbiAgICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGV2ZW50IGxpc3RlbmVyIGFuZCB3YXRjaGVzLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgJG9uRGVzdHJveVxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgU3RhdHVzVGlja2V0cy5wcm90b3R5cGUuJG9uRGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX3Vud2F0Y2goKTtcbiAgfTtcblxuICAvL1xuICAvLyBSRUdJU1RSWVxuICAvL1xuICBhbmd1bGFyLm1vZHVsZShtb2R1bGUpLmRpcmVjdGl2ZSgnc3RhdHVzVGlja2V0cycsIGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjb3BlOiB7fSxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogU3RhdHVzVGlja2V0cyxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyQXM6ICdzdGF0dXNUaWNrZXRzQ29udHJvbGxlcicsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2RpcmVjdGl2ZXMvc3RhdHVzLXRpY2tldHMuaHRtbCdcbiAgICB9O1xuICB9KTtcblxufSkoQU5HVUxBUl9NT0RVTEUsIGFuZ3VsYXIpO1xuIl19
