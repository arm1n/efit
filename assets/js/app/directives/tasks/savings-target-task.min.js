/*!
 * eFit Website
 * An app for financial training in educational environments
 * http://www.e-fit.com
 * @author Armin Pfurtscheller
 * @version 1.0.0
 * Copyright 2017. MIT licensed.
 */
!function(t,e){"use strict";var s=function(t,e,s,i){var o=i.get("TYPE_SAVINGS_TARGET");this.$attrs=s,this.$scope=t,this.$element=e,this.$injector=i,this.user=this.$injector.get("user"),this.task=this.user.getTaskByType(o),this.result=this.user.getPendingByType(o),this.storage=this.$injector.get("storage").getProxy(),this._storageKey="__savings__target__task__updated__at__"};s.$inject=["$scope","$element","$attrs","$injector"],s.prototype.user=null,s.prototype.task=null,s.prototype.result=null,s.prototype.step=1,s.prototype.total=3,s.prototype.wish=null,s.prototype.amount=null,s.prototype.amountRepeated=null,s.prototype.resolved=!1,s.prototype.form=null,s.prototype.$onInit=function(){this.init()},s.prototype.getPayload=function(){var t={task:this.task,json:{step:this.step,wish:this.wish,total:this.total,amount:this.amount,amountRepeated:this.amountRepeated},isPending:null===this.amountRepeated};return null!==this.result&&(t=e.extend(this.result,t)),t},s.prototype.isLocked=function(){return null===this.task||(this.task.isActive?!!this._flag:(this.storage.removeItem(this._storageKey),this._flag=0,!0))},s.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.form.$invalid&&(!this.isLocked()&&!this.resolved))},s.prototype.init=function(){if(null!==this.result){var t=this.result.json,s=this.storage.getItem(this._storageKey);e.isNumber(s)&&(this._flag=s>=this.task.updatedAt),this.amountRepeated=t.amountRepeated||100,this.amount=t.amount,this.total=t.total,this.wish=t.wish,this.step=t.step}this.resolved=!1},s.prototype.reset=function(){this.init()},s.prototype.update=function(){if(this.step<this.total&&this.step++,this.canResolve()){var t=this,e=function(){},s=function(){t.step--};this.resolve().then(e,s)}},s.prototype.resolve=function(){var t=this.$injector.get("notification"),e=this.$injector.get("i18n"),s=this.$injector.get("$q"),i=null===this.result?this.onResolve:this.onUpdate,o=i({payload:this.getPayload()}),n=this,r=function(s){if(s.isPending){if(n.step<n.total){var i=e.get("Thank you for your input!");t.success(i)}return n.result=s,n.storage.setItem(n._storageKey,n.task.updatedAt),void(n._flag=1)}n.resolved=!0},a=function(){},u=s.when(o);return u.then(r,a),u},s.prototype.getDifference=function(){return this.amountRepeated-this.amount},e.module(t).directive("savingsTargetTask",function(){return{scope:{onUpdate:"&savingsTargetTaskOnUpdate",onResolve:"&savingsTargetTaskOnResolve"},restrict:"A",transclude:!0,controller:s,bindToController:!0,controllerAs:"savingsTargetTaskController",templateUrl:"views/directives/tasks/savings-target-task.html"}})}(ANGULAR_MODULE,angular);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9kaXJlY3RpdmVzL3Rhc2tzL3NhdmluZ3MtdGFyZ2V0LXRhc2suanMiXSwibmFtZXMiOlsibW9kdWxlIiwiYW5ndWxhciIsIlNhdmluZ3NUYXJnZXRUYXNrIiwiJHNjb3BlIiwiJGVsZW1lbnQiLCIkYXR0cnMiLCIkaW5qZWN0b3IiLCJ0eXBlIiwiZ2V0IiwidGhpcyIsInVzZXIiLCJ0YXNrIiwiZ2V0VGFza0J5VHlwZSIsInJlc3VsdCIsImdldFBlbmRpbmdCeVR5cGUiLCJzdG9yYWdlIiwiZ2V0UHJveHkiLCJfc3RvcmFnZUtleSIsIiRpbmplY3QiLCJwcm90b3R5cGUiLCJzdGVwIiwidG90YWwiLCJ3aXNoIiwiYW1vdW50IiwiYW1vdW50UmVwZWF0ZWQiLCJyZXNvbHZlZCIsImZvcm0iLCIkb25Jbml0IiwiaW5pdCIsImdldFBheWxvYWQiLCJwYXlsb2FkIiwianNvbiIsImlzUGVuZGluZyIsImV4dGVuZCIsImlzTG9ja2VkIiwiaXNBY3RpdmUiLCJfZmxhZyIsInJlbW92ZUl0ZW0iLCJjYW5SZXNvbHZlIiwiaXNVc2VyIiwiJGludmFsaWQiLCJ1cGRhdGVkQXQiLCJnZXRJdGVtIiwiaXNOdW1iZXIiLCJyZXNldCIsInVwZGF0ZSIsIm1lIiwic3VjY2Vzc0NhbGxiYWNrIiwiZmFpbHVyZUNhbGxiYWNrIiwicmVzb2x2ZSIsInRoZW4iLCJub3RpZmljYXRpb24iLCJpMThuIiwiJHEiLCJjYWxsYmFjayIsIm9uUmVzb2x2ZSIsIm9uVXBkYXRlIiwibWVzc2FnZSIsInN1Y2Nlc3MiLCJzZXRJdGVtIiwicHJvbWlzZSIsIndoZW4iLCJnZXREaWZmZXJlbmNlIiwiZGlyZWN0aXZlIiwic2NvcGUiLCJyZXN0cmljdCIsInRyYW5zY2x1ZGUiLCJjb250cm9sbGVyIiwiYmluZFRvQ29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiQU5HVUxBUl9NT0RVTEUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0NBU0EsU0FBVUEsRUFBUUMsR0FD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QUFlMUMsS0FBS0gsVUFBVUUsSUFBSSxnQkFDbEM0QyxFQUFPM0MsS0FBS0gsVUFBVUUsSUFBSSxRQUMxQjZDLEVBQUs1QyxLQUFLSCxVQUFVRSxJQUFJLE1BRXhCOEMsRUFBMkIsT0FBaEI3QyxLQUFLSSxPQUNsQkosS0FBSzhDLFVBQ0w5QyxLQUFLK0MsU0FFSDNDLEVBQVN5QyxHQUNYeEIsUUFBU3JCLEtBQUtvQixlQUdaaUIsRUFBS3JDLEtBQ0xzQyxFQUFrQixTQUFTbEMsR0FDN0IsR0FBSUEsRUFBT21CLFVBQVcsQ0FDcEIsR0FBSWMsRUFBRzFCLEtBQU8wQixFQUFHekIsTUFBTyxDQUN0QixHQUFJb0MsR0FBVUwsRUFBSzVDLElBQUksNEJBQ3ZCMkMsR0FBYU8sUUFBUUQsR0FXdkIsTUFSQVgsR0FBR2pDLE9BQVNBLEVBRVppQyxFQUFHL0IsUUFBUTRDLFFBQ1RiLEVBQUc3QixZQUNINkIsRUFBR25DLEtBQUs4QixnQkFHVkssRUFBR1YsTUFBUSxHQUliVSxFQUFHckIsVUFBVyxHQUdadUIsRUFBa0IsYUFHbEJZLEVBQVVQLEVBQUdRLEtBQUtoRCxFQU10QixPQUxBK0MsR0FBUVYsS0FDTkgsRUFDQUMsR0FHS1ksR0FVVDFELEVBQWtCaUIsVUFBVTJDLGNBQWdCLFdBQzFDLE1BQU9yRCxNQUFLZSxlQUFpQmYsS0FBS2MsUUFNcEN0QixFQUFRRCxPQUFPQSxHQUFRK0QsVUFBVSxvQkFBcUIsV0FDcEQsT0FDRUMsT0FDRVIsU0FBVSw2QkFDVkQsVUFBVywrQkFFYlUsU0FBVSxJQUNWQyxZQUFZLEVBQ1pDLFdBQVlqRSxFQUNaa0Usa0JBQWtCLEVBQ2xCQyxhQUFjLDhCQUNkQyxZQUFhLHNEQUloQkMsZUFBZ0J0RSIsImZpbGUiOiJhcHAvZGlyZWN0aXZlcy90YXNrcy9zYXZpbmdzLXRhcmdldC10YXNrLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBBTkdVTEFSX01PRFVMRSwgYW5ndWxhciAqL1xuKGZ1bmN0aW9uKG1vZHVsZSwgYW5ndWxhcikge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gU2F2aW5nc1RhcmdldFRhc2tcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvL1xuICAvLyBDT05UUk9MTEVSXG4gIC8vXG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgdmFyIFNhdmluZ3NUYXJnZXRUYXNrID0gZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkaW5qZWN0b3IpIHtcbiAgICB2YXIgdHlwZSA9ICRpbmplY3Rvci5nZXQoJ1RZUEVfU0FWSU5HU19UQVJHRVQnKTtcblxuICAgIHRoaXMuJGF0dHJzID0gJGF0dHJzO1xuICAgIHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuICAgIHRoaXMuJGVsZW1lbnQgPSAkZWxlbWVudDtcbiAgICB0aGlzLiRpbmplY3RvciA9ICRpbmplY3RvcjtcblxuICAgIHRoaXMudXNlciA9IHRoaXMuJGluamVjdG9yLmdldCgndXNlcicpO1xuICAgIHRoaXMudGFzayA9IHRoaXMudXNlci5nZXRUYXNrQnlUeXBlKHR5cGUpO1xuICAgIHRoaXMucmVzdWx0ID0gdGhpcy51c2VyLmdldFBlbmRpbmdCeVR5cGUodHlwZSk7XG5cbiAgICB0aGlzLnN0b3JhZ2UgPSB0aGlzLiRpbmplY3Rvci5nZXQoJ3N0b3JhZ2UnKS5nZXRQcm94eSgpO1xuICAgIHRoaXMuX3N0b3JhZ2VLZXkgPSAnX19zYXZpbmdzX190YXJnZXRfX3Rhc2tfX3VwZGF0ZWRfX2F0X18nO1xuICB9O1xuXG4gIFNhdmluZ3NUYXJnZXRUYXNrLiRpbmplY3QgPSBbJyRzY29wZScsJyRlbGVtZW50JywnJGF0dHJzJywgJyRpbmplY3RvciddO1xuXG4gIC8vIFNFUlZFUlxuXG4gIC8qKiBAdmFyIHtvYmplY3R9IHVzZXIgQWxpYXMgdG8gdXNlciBzZXJ2aWNlLiAqL1xuICBTYXZpbmdzVGFyZ2V0VGFzay5wcm90b3R5cGUudXNlciA9IG51bGw7XG5cbiAgLyoqIEB2YXIge29iamVjdH0gdGFzayBUYXNrJ3MgcmVzb3VyY2UgZnJvbSBzZXJ2ZXIuICovXG4gIFNhdmluZ3NUYXJnZXRUYXNrLnByb3RvdHlwZS50YXNrID0gbnVsbDtcblxuICAvKiogQHZhciB7b2JqZWN0fSByZXN1bHQgVGFzaydzIHBlbmRpbmcgcmVzdWx0IGZyb20gc2VydmVyLiAqL1xuICBTYXZpbmdzVGFyZ2V0VGFzay5wcm90b3R5cGUucmVzdWx0ID0gbnVsbDtcblxuICAvLyBHQU1FUExBWVxuXG4gIC8qKiBAdmFyIHtudW1iZXJ9IHN0ZXAgQ3VycmVudCBzdGVwIC4gKi9cbiAgU2F2aW5nc1RhcmdldFRhc2sucHJvdG90eXBlLnN0ZXAgPSAxO1xuXG4gIC8qKiBAdmFyIHtudW1iZXJ9IHRvdGFsIFBsYXllcnMgd2lzaCBmb3Igc2F2aW5nIHRhcmdldC4gKi9cbiAgU2F2aW5nc1RhcmdldFRhc2sucHJvdG90eXBlLnRvdGFsID0gMztcblxuICAvKiogQHZhciB7c3RyaW5nfSB3aXNoIFBsYXllcnMgd2lzaCBmb3Igc2F2aW5nIHRhcmdldC4gKi9cbiAgU2F2aW5nc1RhcmdldFRhc2sucHJvdG90eXBlLndpc2ggPSBudWxsO1xuXG4gIC8qKiBAdmFyIHtudW1iZXJ9IGFtb3VudCBQbGF5ZXJzIGZpcnN0IGFtb3VudCBmb3Igc2F2aW5nIHRhcmdldC4gKi9cbiAgU2F2aW5nc1RhcmdldFRhc2sucHJvdG90eXBlLmFtb3VudCA9IG51bGw7XG5cbiAgLyoqIEB2YXIge251bWJlcn0gYW1vdW50UmVwZWF0ZWQgUGxheWVycyBzZWNvbmQgYW1vdW50IGZvciBzYXZpbmcgdGFyZ2V0LiAqL1xuICBTYXZpbmdzVGFyZ2V0VGFzay5wcm90b3R5cGUuYW1vdW50UmVwZWF0ZWQgPSBudWxsO1xuXG4gIC8qKiBAdmFyIHtib29sZWFufSByZXNvbHZlZCBJZiBwbGF5ZXIgaGFzIHJlc29sdmVkIHRoZSBnYW1lLiAqL1xuICBTYXZpbmdzVGFyZ2V0VGFzay5wcm90b3R5cGUucmVzb2x2ZWQgPSBmYWxzZTtcblxuICAvLyBNSVNDXG5cbiAgLyoqIEB2YXIge29iamVjdH0gZm9ybSBGb3JtIGNvbGxlY3RpbmcgdXNlciBpbnB1dC4gKi9cbiAgU2F2aW5nc1RhcmdldFRhc2sucHJvdG90eXBlLmZvcm0gPSBudWxsO1xuXG4gIC8vXG4gIC8vIE1FVEhPRFNcbiAgLy9cblxuICAvKipcbiAgICogUHJveGllcyB0byBgaW5pdCgpYCBpZiBjb250cm9sbGVyJ3MgcmVhZHkuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCAkb25Jbml0XG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICBTYXZpbmdzVGFyZ2V0VGFzay5wcm90b3R5cGUuJG9uSW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdCgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgcmVzdWx0IHBheWxvYWQgZm9yIHNlcnZlci5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIGdldFBheWxvYWRcbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIFNhdmluZ3NUYXJnZXRUYXNrLnByb3RvdHlwZS5nZXRQYXlsb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBheWxvYWQgPSB7XG4gICAgICB0YXNrOiB0aGlzLnRhc2ssXG4gICAgICBqc29uOiB7XG4gICAgICAgIHN0ZXA6IHRoaXMuc3RlcCxcbiAgICAgICAgd2lzaDogdGhpcy53aXNoLFxuICAgICAgICB0b3RhbDogdGhpcy50b3RhbCxcbiAgICAgICAgYW1vdW50OiB0aGlzLmFtb3VudCxcbiAgICAgICAgYW1vdW50UmVwZWF0ZWQ6IHRoaXMuYW1vdW50UmVwZWF0ZWRcbiAgICAgIH0sXG4gICAgICBpc1BlbmRpbmc6IHRoaXMuYW1vdW50UmVwZWF0ZWQgPT09IG51bGxcbiAgICB9O1xuXG4gICAgaWYgKHRoaXMucmVzdWx0ICE9PSBudWxsKSB7XG4gICAgICBwYXlsb2FkID0gYW5ndWxhci5leHRlbmQoXG4gICAgICAgIHRoaXMucmVzdWx0LFxuICAgICAgICBwYXlsb2FkXG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBwYXlsb2FkO1xuICB9O1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIG9yIG5vdCB0YXNrIGlzIGN1cnJlbnRseSBsb2NrZWQuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCBpc0xvY2tlZFxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgU2F2aW5nc1RhcmdldFRhc2sucHJvdG90eXBlLmlzTG9ja2VkID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMudGFzayA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gaWYgcmVzdWx0IHdhcyBjcmVhdGVkIGFuZFxuICAgIC8vIHdlIGFyZSB3YWl0aW5nIGZvciBwYXVzZWRcbiAgICAvLyBzdGF0ZSwgd2Ugc2tpcCB1bmxvY2tpbmdcbiAgICAvLyBieSB1c2luZyBpbnRlcm5hbCBgX2ZsYWdgXG4gICAgaWYgKHRoaXMudGFzay5pc0FjdGl2ZSkge1xuICAgICAgcmV0dXJuICEhdGhpcy5fZmxhZztcbiAgICB9XG5cbiAgICAvLyByZXNldCBgX2ZsYWdgIGFzIHNvb24gYXNcbiAgICAvLyBgaXNBY3RpdmVgIGNoYW5nZWQgYWdhaW5cbiAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShcbiAgICAgIHRoaXMuX3N0b3JhZ2VLZXlcbiAgICApO1xuXG4gICAgdGhpcy5fZmxhZyA9IDA7XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgb3Igbm90IHRhc2sgY2FuIGJlIHNlbnQgdG8gc2VydmVyLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgY2FuUmVzb2x2ZVxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgU2F2aW5nc1RhcmdldFRhc2sucHJvdG90eXBlLmNhblJlc29sdmUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdXNlciA9IHRoaXMuJGluamVjdG9yLmdldCgndXNlcicpO1xuICAgIGlmICghdXNlci5pc1VzZXIoKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmZvcm0uJGludmFsaWQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0xvY2tlZCgpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucmVzb2x2ZWQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICAvKipcbiAgICogU2V0cyB1cCBpbml0aWFsIHN0YXRlLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgaW5pdFxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgU2F2aW5nc1RhcmdldFRhc2sucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5yZXN1bHQgIT09IG51bGwpIHtcbiAgICAgIHZhciBqc29uID0gdGhpcy5yZXN1bHQuanNvbjtcblxuICAgICAgLy8gc2V0IGZsYWcgb25seSBpZiBzdGlsbCB3YWl0aW5nIGZvciBgaXNBY3RpdmVgIGNoYW5nZVxuICAgICAgdmFyIHVwZGF0ZWRBdCA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHRoaXMuX3N0b3JhZ2VLZXkpO1xuICAgICAgaWYgKGFuZ3VsYXIuaXNOdW1iZXIodXBkYXRlZEF0KSkge1xuICAgICAgICB0aGlzLl9mbGFnID0gdXBkYXRlZEF0ID49IHRoaXMudGFzay51cGRhdGVkQXQ7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYW1vdW50UmVwZWF0ZWQgPSBqc29uLmFtb3VudFJlcGVhdGVkIHx8wqAxMDA7XG4gICAgICB0aGlzLmFtb3VudCA9IGpzb24uYW1vdW50O1xuICAgICAgdGhpcy50b3RhbCA9IGpzb24udG90YWw7XG4gICAgICB0aGlzLndpc2ggPSBqc29uLndpc2g7XG4gICAgICB0aGlzLnN0ZXAgPSBqc29uLnN0ZXA7XG4gICAgfVxuXG4gICAgdGhpcy5yZXNvbHZlZCA9IGZhbHNlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXNldHMgaW5pdGlhbCBzdGF0ZS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIHJlc2V0XG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICBTYXZpbmdzVGFyZ2V0VGFzay5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuaW5pdCgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbmNyZWFzZXMgYHN0ZXBgIGFuZCBpbnZva2VzIGByZXNvbHZlKClgLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgdXBkYXRlXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICBTYXZpbmdzVGFyZ2V0VGFzay5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKXtcbiAgICBpZiAodGhpcy5zdGVwIDwgdGhpcy50b3RhbCkge1xuICAgICAgdGhpcy5zdGVwKys7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmNhblJlc29sdmUoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBtZSA9IHRoaXM7XG4gICAgdmFyIHN1Y2Nlc3NDYWxsYmFjayA9IGZ1bmN0aW9uKCl7fTtcbiAgICB2YXIgZmFpbHVyZUNhbGxiYWNrID0gZnVuY3Rpb24oKXtcbiAgICAgIG1lLnN0ZXAtLTtcbiAgICB9O1xuXG4gICAgdGhpcy5yZXNvbHZlKCkudGhlbihcbiAgICAgIHN1Y2Nlc3NDYWxsYmFjayxcbiAgICAgIGZhaWx1cmVDYWxsYmFja1xuICAgICk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldHMgYHJlc29sdmVkYCBmbGFnLiBDYWxscyBgb25SZXNvbHZlYFxuICAgKiBjYWxsYmFjayB3aXRoIEpTT04gcmVzdWx0IGZvciBjb25zdW1lci5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIHJlc29sdmVcbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIFNhdmluZ3NUYXJnZXRUYXNrLnByb3RvdHlwZS5yZXNvbHZlID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgbm90aWZpY2F0aW9uID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCdub3RpZmljYXRpb24nKTtcbiAgICB2YXIgaTE4biA9IHRoaXMuJGluamVjdG9yLmdldCgnaTE4bicpO1xuICAgIHZhciAkcSA9IHRoaXMuJGluamVjdG9yLmdldCgnJHEnKTtcblxuICAgIHZhciBjYWxsYmFjayA9IHRoaXMucmVzdWx0ID09PSBudWxsID9cbiAgICAgIHRoaXMub25SZXNvbHZlIDpcbiAgICAgIHRoaXMub25VcGRhdGU7XG5cbiAgICB2YXIgcmVzdWx0ID0gY2FsbGJhY2soe1xuICAgICAgcGF5bG9hZDogdGhpcy5nZXRQYXlsb2FkKClcbiAgICB9KTtcblxuICAgIHZhciBtZSA9IHRoaXM7XG4gICAgdmFyIHN1Y2Nlc3NDYWxsYmFjayA9IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgaWYgKHJlc3VsdC5pc1BlbmRpbmcpIHtcbiAgICAgICAgaWYgKG1lLnN0ZXAgPCBtZS50b3RhbCkge1xuICAgICAgICAgIHZhciBtZXNzYWdlID0gaTE4bi5nZXQoJ1RoYW5rIHlvdSBmb3IgeW91ciBpbnB1dCEnKTtcbiAgICAgICAgICBub3RpZmljYXRpb24uc3VjY2VzcyhtZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1lLnJlc3VsdCA9IHJlc3VsdDtcblxuICAgICAgICBtZS5zdG9yYWdlLnNldEl0ZW0oXG4gICAgICAgICAgbWUuX3N0b3JhZ2VLZXksXG4gICAgICAgICAgbWUudGFzay51cGRhdGVkQXRcbiAgICAgICAgKTtcblxuICAgICAgICBtZS5fZmxhZyA9IDE7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWUucmVzb2x2ZWQgPSB0cnVlO1xuICAgIH07XG5cbiAgICB2YXIgZmFpbHVyZUNhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgfTtcblxuICAgIHZhciBwcm9taXNlID0gJHEud2hlbihyZXN1bHQpO1xuICAgIHByb21pc2UudGhlbihcbiAgICAgIHN1Y2Nlc3NDYWxsYmFjayxcbiAgICAgIGZhaWx1cmVDYWxsYmFja1xuICAgICk7XG5cbiAgICByZXR1cm4gcHJvbWlzZTtcbiAgfTtcblxuICAvKipcbiAgICogQ2FsY3VsYXRlcyBkaWZmZXJlbmNlIGJldHdlZW4gYGFtb3VudGAgYW5kIGBhbW91bnRSZXBlYXRlZGAuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCBnZXREaWZmZXJlbmNlXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICBTYXZpbmdzVGFyZ2V0VGFzay5wcm90b3R5cGUuZ2V0RGlmZmVyZW5jZSA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuYW1vdW50UmVwZWF0ZWQgLSB0aGlzLmFtb3VudDtcbiAgfTtcblxuICAvL1xuICAvLyBSRUdJU1RSWVxuICAvL1xuICBhbmd1bGFyLm1vZHVsZShtb2R1bGUpLmRpcmVjdGl2ZSgnc2F2aW5nc1RhcmdldFRhc2snLCBmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICBzY29wZToge1xuICAgICAgICBvblVwZGF0ZTogJyZzYXZpbmdzVGFyZ2V0VGFza09uVXBkYXRlJyxcbiAgICAgICAgb25SZXNvbHZlOiAnJnNhdmluZ3NUYXJnZXRUYXNrT25SZXNvbHZlJ1xuICAgICAgfSxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogU2F2aW5nc1RhcmdldFRhc2ssXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlckFzOiAnc2F2aW5nc1RhcmdldFRhc2tDb250cm9sbGVyJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvZGlyZWN0aXZlcy90YXNrcy9zYXZpbmdzLXRhcmdldC10YXNrLmh0bWwnXG4gICAgfTtcbiAgfSk7XG5cbn0pKEFOR1VMQVJfTU9EVUxFLCBhbmd1bGFyKTtcbiJdfQ==
