/*!
 * eFit Website
 * An app for financial training in educational environments
 * http://www.e-fit.com
 * @author Armin Pfurtscheller
 * @version 1.0.0
 * Copyright 2017. MIT licensed.
 */
!function(t,o){"use strict";var e=function(t,o,e,i){var s=i.get("TYPE_RISK"),r=i.get("user");this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this.task=r.getTaskByType(s)};e.$inject=["$scope","$attrs","$element","$injector"],e.prototype.task=null,e.prototype.started=!1,e.prototype.stopped=!1,e.prototype.hasBomb=!1,e.prototype.resolved=!1,e.prototype.totalBoxes=0,e.prototype.remainingBoxes=0,e.prototype.collectedBoxes=0,e.prototype.avg=12,e.prototype.rows=5,e.prototype.cols=5,e.prototype.interval=1,e.prototype.random=!1,e.prototype.dynamic=!1,e.prototype.$onInit=function(){this.init()},e.prototype.getPayload=function(){return{task:this.task,json:{hasBomb:this.hasBomb,collectedBoxes:this.collectedBoxes},ticketCount:this.getTicketCount()}},e.prototype.isLocked=function(){return null===this.task||!this.task.isActive},e.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!this.resolved&&(this.dynamic?this.stopped:!!this.collectedBoxes)))},e.prototype.init=function(){this._initMembers(),this._initMatrix(),this._initBomb(),this.dynamic||this.start()},e.prototype.reset=function(){this.init()},e.prototype.start=function(t){if(this.dynamic){var o=this.$injector.get("$interval");this._intIndex=t||0;var e=this,i=this.iterator.length;this._intervalId=o(function(){var t=e.iterator[e._intIndex];e.update(t,!0),e._intIndex++,e._intIndex===i&&e.stop()},1e3*this.interval,i-this._intIndex)}this.started=!0},e.prototype.stop=function(){if(this.dynamic&&this._intervalId){var t=this.$injector.get("$interval");t.cancel(this._intervalId)}this.stopped=!0},e.prototype.resolve=function(){var t=this.$injector.get("$q"),e=this.onResolve({payload:this.getPayload()}),i=function(t){t.$$resolved=!0},s=this,r=function(){o.forEach(s.collection,i),s.resolved=!0},n=function(){},a=t.when(e);return a.then(r,n),a},e.prototype.getTicketCount=function(){return this.hasBomb?1:this.collectedBoxes+1},e.prototype.toggle=function(t,o){var e=this.collection.indexOf(t);o?(e<0&&(this.collection.push(t),this.collectedBoxes++),t.$$active=!0):e>=0&&(this.collection.splice(e,1),t.$$active=!1,this.collectedBoxes--),this.isBomb(t)&&(this.hasBomb=!0);var i=this.totalBoxes,s=this.collectedBoxes;this.remainingBoxes=i-s},e.prototype.trackId=function(t){return t.row+"_"+t.col},e.prototype.isBomb=function(t){return o.equals(this.bomb,t)},e.prototype._initMembers=function(){this.collection=[],this.hasBomb=!1,this.started=!1,this.stopped=!1,this.resolved=!1,this.collectedBoxes=0,this.remainingBoxes=0,this.totalBoxes=this.rows*this.cols},e.prototype._initMatrix=function(){this.matrix=[],this.iterator=[];for(var t=0;t<this.rows;t++){for(var o=[],e=0;e<this.cols;e++){var i={row:t+1,col:e+1};if(o.push(i),this.dynamic)if(this.random){var s=this.$injector.get("random");s.push(this.iterator,i)}else this.iterator.push(i)}this.matrix.push(o)}},e.prototype._initBomb=function(){var t=this.$injector.get("random"),o=t.between(0,this.rows-1),e=t.between(0,this.cols-1);this.bomb=this.matrix[o][e]},o.module(t).directive("bombTask",function(){return{scope:{avg:"=?bombTaskAvg",rows:"=?bombTaskRows",cols:"=?bombTaskCols",random:"=?bombTaskRandom",dynamic:"=?bombTaskDynamic",interval:"=?bombTaskInterval",onResolve:"&bombTaskOnResolve"},restrict:"A",transclude:!0,controller:e,bindToController:!0,controllerAs:"bombTaskController",templateUrl:"views/directives/tasks/bomb-task.html"}});var i=function(){};i.prototype.model=null,i.prototype.isActive=!1,i.prototype.isDisabled=!1,i.prototype.isClickable=!0,i.prototype.toggle=function(){!this.isDisabled&&this.isClickable&&(this.isActive=!this.isActive,this.onToggle({model:this.model,state:this.isActive}))},o.module(t).directive("bombTaskCard",function(){return{scope:{model:"=bombTaskCard",onToggle:"&bombTaskCardOnToggle",isActive:"=?bombTaskCardIsActive",isDisabled:"=?bombTaskCardIsDisabled",isClickable:"=?bombTaskCardIsClickable"},restrict:"A",transclude:!0,controller:i,bindToController:!0,controllerAs:"bombTaskCardController",templateUrl:"views/directives/tasks/bomb-task-card.html"}})}(ANGULAR_MODULE,angular);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9kaXJlY3RpdmVzL3Rhc2tzL2JvbWItdGFzay5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJhbmd1bGFyIiwiQm9tYlRhc2siLCIkc2NvcGUiLCIkYXR0cnMiLCIkZWxlbWVudCIsIiRpbmplY3RvciIsInR5cGUiLCJnZXQiLCJ1c2VyIiwidGhpcyIsInRhc2siLCJnZXRUYXNrQnlUeXBlIiwiJGluamVjdCIsInByb3RvdHlwZSIsInN0YXJ0ZWQiLCJzdG9wcGVkIiwiaGFzQm9tYiIsInJlc29sdmVkIiwidG90YWxCb3hlcyIsInJlbWFpbmluZ0JveGVzIiwiY29sbGVjdGVkQm94ZXMiLCJhdmciLCJyb3dzIiwiY29scyIsImludGVydmFsIiwicmFuZG9tIiwiZHluYW1pYyIsIiRvbkluaXQiLCJpbml0IiwiZ2V0UGF5bG9hZCIsImpzb24iLCJ0aWNrZXRDb3VudCIsImdldFRpY2tldENvdW50IiwiaXNMb2NrZWQiLCJpc0FjdGl2ZSIsImNhblJlc29sdmUiLCJpc1VzZXIiLCJfaW5pdE1lbWJlcnMiLCJfaW5pdE1hdHJpeCIsIl9pbml0Qm9tYiIsInN0YXJ0IiwicmVzZXQiLCJpbmRleCIsIiRpbnRlcnZhbCIsIl9pbnRJbmRleCIsIm1lIiwibWF4IiwiaXRlcmF0b3IiLCJsZW5ndGgiLCJfaW50ZXJ2YWxJZCIsIml0ZW0iLCJ1cGRhdGUiLCJzdG9wIiwiY2FuY2VsIiwicmVzb2x2ZSIsIiRxIiwicmVzdWx0Iiwib25SZXNvbHZlIiwicGF5bG9hZCIsInJlc29sdmVDYXJkIiwiY2FyZCIsIiQkcmVzb2x2ZWQiLCJzdWNjZXNzQ2FsbGJhY2siLCJmb3JFYWNoIiwiY29sbGVjdGlvbiIsImZhaWx1cmVDYWxsYmFjayIsInByb21pc2UiLCJ3aGVuIiwidGhlbiIsInRvZ2dsZSIsImNvbHVtbiIsImFjdGl2ZSIsImluZGV4T2YiLCJwdXNoIiwiJCRhY3RpdmUiLCJzcGxpY2UiLCJpc0JvbWIiLCJ0b3RhbCIsImNvbGxlY3RlZCIsInRyYWNrSWQiLCJyb3ciLCJjb2wiLCJlcXVhbHMiLCJib21iIiwibWF0cml4IiwiaSIsImNvbHVtbnMiLCJqIiwiZGF0YSIsImJldHdlZW4iLCJkaXJlY3RpdmUiLCJzY29wZSIsInJlc3RyaWN0IiwidHJhbnNjbHVkZSIsImNvbnRyb2xsZXIiLCJiaW5kVG9Db250cm9sbGVyIiwiY29udHJvbGxlckFzIiwidGVtcGxhdGVVcmwiLCJCb21iVGFza0NhcmQiLCJtb2RlbCIsImlzRGlzYWJsZWQiLCJpc0NsaWNrYWJsZSIsIm9uVG9nZ2xlIiwic3RhdGUiLCJBTkdVTEFSX01PRFVMRSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Q0FTQSxTQUFVQSxFQUFRQyxHQUNoQixZQWFBLElBQUlDLEdBQVcsU0FBU0MsRUFBUUMsRUFBUUMsRUFBVUMsR0FDaEQsR0FBSUMsR0FBT0QsRUFBVUUsSUFBSSxhQUNyQkMsRUFBT0gsRUFBVUUsSUFBSSxPQUV6QkUsTUFBS1AsT0FBU0EsRUFDZE8sS0FBS04sT0FBU0EsRUFDZE0sS0FBS0wsU0FBV0EsRUFDaEJLLEtBQUtKLFVBQVlBLEVBRWpCSSxLQUFLQyxLQUFPRixFQUFLRyxjQUFjTCxHQUdqQ0wsR0FBU1csU0FBVyxTQUFVLFNBQVUsV0FBWSxhQVNwRFgsRUFBU1ksVUFBVUgsS0FBTyxLQUsxQlQsRUFBU1ksVUFBVUMsU0FBVSxFQUc3QmIsRUFBU1ksVUFBVUUsU0FBVSxFQUc3QmQsRUFBU1ksVUFBVUcsU0FBVSxFQUc3QmYsRUFBU1ksVUFBVUksVUFBVyxFQUc5QmhCLEVBQVNZLFVBQVVLLFdBQWEsRUFHaENqQixFQUFTWSxVQUFVTSxlQUFpQixFQUdwQ2xCLEVBQVNZLFVBQVVPLGVBQWlCLEVBS3BDbkIsRUFBU1ksVUFBVVEsSUFBTSxHQUd6QnBCLEVBQVNZLFVBQVVTLEtBQU8sRUFHMUJyQixFQUFTWSxVQUFVVSxLQUFPLEVBRzFCdEIsRUFBU1ksVUFBVVcsU0FBVyxFQU85QnZCLEVBQVNZLFVBQVVZLFFBQVMsRUFRNUJ4QixFQUFTWSxVQUFVYSxTQUFVLEVBYTdCekIsRUFBU1ksVUFBVWMs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LE9BQVEsbUJBQ1JDLFFBQVMsb0JBQ1RGLFNBQVUscUJBQ1ZpQyxVQUFXLHNCQUVibUMsU0FBVSxJQUNWQyxZQUFZLEVBQ1pDLFdBQVk3RixFQUNaOEYsa0JBQWtCLEVBQ2xCQyxhQUFjLHFCQUNkQyxZQUFhLDBDQWVqQixJQUFJQyxHQUFlLFlBUW5CQSxHQUFhckYsVUFBVXNGLE1BQVEsS0FHL0JELEVBQWFyRixVQUFVcUIsVUFBVyxFQUdsQ2dFLEVBQWFyRixVQUFVdUYsWUFBYSxFQUdwQ0YsRUFBYXJGLFVBQVV3RixhQUFjLEVBZXJDSCxFQUFhckYsVUFBVXdELE9BQVMsWUFDMUI1RCxLQUFLMkYsWUFBZTNGLEtBQUs0RixjQUk3QjVGLEtBQUt5QixVQUFZekIsS0FBS3lCLFNBRXRCekIsS0FBSzZGLFVBQ0hILE1BQU0xRixLQUFLMEYsTUFDWEksTUFBTTlGLEtBQUt5QixhQUtmbEMsRUFBUUQsT0FBT0EsR0FBUTJGLFVBQVUsZUFBZ0IsV0FDL0MsT0FDRUMsT0FDRVEsTUFBTSxnQkFDTkcsU0FBUyx3QkFDVHBFLFNBQVMseUJBQ1RrRSxXQUFXLDJCQUNYQyxZQUFZLDZCQUVkVCxTQUFVLElBQ1ZDLFlBQVksRUFDWkMsV0FBWUksRUFDWkgsa0JBQWtCLEVBQ2xCQyxhQUFjLHlCQUNkQyxZQUFhLGlEQUloQk8sZUFBZ0J4RyIsImZpbGUiOiJhcHAvZGlyZWN0aXZlcy90YXNrcy9ib21iLXRhc2subWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIEFOR1VMQVJfTU9EVUxFLCBhbmd1bGFyICovXG4oZnVuY3Rpb24obW9kdWxlLCBhbmd1bGFyKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBCb21iVGFza1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vXG4gIC8vIENPTlRST0xMRVJcbiAgLy9cblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICB2YXIgQm9tYlRhc2sgPSBmdW5jdGlvbigkc2NvcGUsICRhdHRycywgJGVsZW1lbnQsICRpbmplY3Rvcikge1xuICAgIHZhciB0eXBlID0gJGluamVjdG9yLmdldCgnVFlQRV9SSVNLJyk7XG4gICAgdmFyIHVzZXIgPSAkaW5qZWN0b3IuZ2V0KCd1c2VyJyk7XG5cbiAgICB0aGlzLiRzY29wZSA9ICRzY29wZTtcbiAgICB0aGlzLiRhdHRycyA9ICRhdHRycztcbiAgICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XG4gICAgdGhpcy4kaW5qZWN0b3IgPSAkaW5qZWN0b3I7XG5cbiAgICB0aGlzLnRhc2sgPSB1c2VyLmdldFRhc2tCeVR5cGUodHlwZSk7XG4gIH07XG5cbiAgQm9tYlRhc2suJGluamVjdCA9IFsnJHNjb3BlJywgJyRhdHRycycsICckZWxlbWVudCcsICckaW5qZWN0b3InXTtcblxuICAvL1xuICAvLyBQUk9QRVJUSUVTXG4gIC8vXG5cbiAgLy8gU0VSVkVSXG5cbiAgLyoqIEB2YXIge29iamVjdH0gdGFzayBUYXNrJ3MgcmVzb3VyY2UgZnJvbSBzZXJ2ZXIuICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS50YXNrID0gbnVsbDtcblxuICAvLyBHQU1FUExBWVxuXG4gIC8qKiBAdmFyIHtib29sZWFufSBzdGFydGVkIElmIHRoZSB0YXNrIGhhcyBzdGFydGVkLiAqL1xuICBCb21iVGFzay5wcm90b3R5cGUuc3RhcnRlZCA9IGZhbHNlO1xuXG4gIC8qKiBAdmFyIHtib29sZWFufSBzdG9wcGVkIElmIHRoZSB0YXNrIGhhcyBzdG9wcGVkLiAqL1xuICBCb21iVGFzay5wcm90b3R5cGUuc3RvcHBlZCA9IGZhbHNlO1xuXG4gIC8qKiBAdmFyIHtib29sZWFufSBoYXNCb21iIElmIGJvbWIgaXMgaW4gY3VycmVudCBjb2xsZWN0aW9uLiAqL1xuICBCb21iVGFzay5wcm90b3R5cGUuaGFzQm9tYiA9IGZhbHNlO1xuXG4gIC8qKiBAdmFyIHtib29sZWFufSByZXNvbHZlZCBJZiBwbGF5ZXIgaGFzIHJlc29sdmVkIHRoZSBnYW1lLiAqL1xuICBCb21iVGFzay5wcm90b3R5cGUucmVzb2x2ZWQgPSBmYWxzZTtcblxuICAvKiogQHZhciB7bnVtYmVyfSB0b3RhbEJveGVzIFRvdGFsIGJveGVzIG9mIGN1cnJlbnQgZ2FtZS4gKi9cbiAgQm9tYlRhc2sucHJvdG90eXBlLnRvdGFsQm94ZXMgPSAwO1xuXG4gIC8qKiBAdmFyIHtudW1iZXJ9IHJlbWFpbmluZ0JveGVzIFJlbWFpbmluZyBib3hlcyBvZiBjdXJyZW50IGdhbWUuICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS5yZW1haW5pbmdCb3hlcyA9IDA7XG5cbiAgLyoqIEB2YXIge251bWJlcn0gY29sbGVjdGVkQm94ZXMgQ29sbGVjdGVkIGJveGVzIG9mIGN1cnJlbnQgZ2FtZS4gKi9cbiAgQm9tYlRhc2sucHJvdG90eXBlLmNvbGxlY3RlZEJveGVzID0gMDtcblxuICAvLyBTRVRUSU5HU1xuXG4gIC8qKiBAdmFyIHtudW1iZXJ9IGF2ZyBBdmVyYWdlIG9mIGNvbGxlY3RlZCBib3hlcyBmcm9tIHN0YXRpc3RpY3MuICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS5hdmcgPSAxMjtcblxuICAvKiogQHZhciB7bnVtYmVyfSByb3dzIEFtb3VudCBvZiByb3dzIGZvciBib21iIHRhc2suICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS5yb3dzID0gNTtcblxuICAvKiogQHZhciB7bnVtYmVyfSBjb2xzIEFtb3VudCBvZiBjb2xzIGZvciBib21iIHRhc2suICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS5jb2xzID0gNTtcblxuICAvKiogQHZhciB7bnVtYmVyfSBpbnRlcnZhbCBUaW1lb3V0IGZvciBpbnRlcnZhbCBpbiBzZWNvbmRzLiAqL1xuICBCb21iVGFzay5wcm90b3R5cGUuaW50ZXJ2YWwgPSAxO1xuXG4gIC8qKiBAdmFyIHtib29sZWFufSByYW5kb21cbiAgICogLSBJZiBgcmFuZG9tYCA9IGZhbHNlLCBib3hlcyBhcmUgY29sbGVjdGVkIHJvdy13aXNlIG9uZS1ieS1vbmUsIHN0YXJ0aW5nIGluIHRoZSB0b3AtbGVmdCBjb3JuZXJcbiAgICogLSBJZiBgcmFuZG9tYCA9IHRydWUsIGJveGVzIGFyZSBjb2xsZWN0ZWQgcmFuZG9tbHkgKEZpc2hlci1ZYXRlcyBBbGdvcml0aG0pXG4gICAqIE5vdGUgdGhhdCB0aGlzIGFmZmVjdHMgZ2FtZSBwbGF5IGluZGVwZW5kZW50bHkgb2YgYGR5bmFtaWNgIHByb3BlcnR5XG4gICAqL1xuICBCb21iVGFzay5wcm90b3R5cGUucmFuZG9tID0gZmFsc2U7XG5cbiAgLyoqIEB2YXIge2Jvb2xlYW59IGR5bmFtaWNcbiAgICogLSBJZiBgZHluYW1pY2AgPSB0cnVlLCBvbmUgYm94IHBlciB0aW1lIGludGVydmFsIGlzIGNvbGxlY3RlZCBhdXRvbWF0aWNhbGx5XG4gICAqIC0gSW4gY2FzZSBvZiBgZHluYW1pY2AgPSB0cnVlLCBnYW1lIHBsYXkgaXMgYWZmZWN0ZWQgYnkgdGhlIHZhcmlhYmxlcyBgaW50ZXJ2YWxgIGFuZCBgcmFuZG9tYFxuICAgKiAtIElmIGBkeW5hbWljYCA9IGZhbHNlLCBzdWJqZWN0cyBjb2xsZWN0IGFzIG1hbnkgYm94ZXMgYXMgdGhleSB3YW50IGJ5IGNsaWNraW5nIG9yIGVudGVyaW5nIHRoZSByZXNwZWN0aXZlIG51bWJlclxuICAgKiAtIEluIGNhc2Ugb2YgYGR5bmFtaWNgID0gZmFsc2UsIGdhbWUgcGxheSBpcyBhZmZlY3RlZCBieSB0aGUgdmFyaWFibGVzIGByYW5kb21gXG4gICAqL1xuICBCb21iVGFzay5wcm90b3R5cGUuZHluYW1pYyA9IGZhbHNlO1xuXG4gIC8vXG4gIC8vIE1FVEhPRFNcbiAgLy9cblxuICAvKipcbiAgICogUHJveGllcyB0byBgaW5pdCgpYCBpZiBjb250cm9sbGVyJ3MgcmVhZHkuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCAkb25Jbml0XG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICBCb21iVGFzay5wcm90b3R5cGUuJG9uSW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdCgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgcmVzdWx0IHBheWxvYWQgZm9yIHNlcnZlci5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIGdldFBheWxvYWRcbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS5nZXRQYXlsb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRhc2s6IHRoaXMudGFzayxcbiAgICAgIGpzb246IHtcbiAgICAgICAgaGFzQm9tYjogdGhpcy5oYXNCb21iLFxuICAgICAgICBjb2xsZWN0ZWRCb3hlczogdGhpcy5jb2xsZWN0ZWRCb3hlc1xuICAgICAgfSxcbiAgICAgIHRpY2tldENvdW50OiB0aGlzLmdldFRpY2tldENvdW50KClcbiAgICB9O1xuICB9O1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIG9yIG5vdCB0YXNrIGlzIGN1cnJlbnRseSBsb2NrZWQuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCBpc0xvY2tlZFxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgQm9tYlRhc2sucHJvdG90eXBlLmlzTG9ja2VkID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMudGFzayA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuICF0aGlzLnRhc2suaXNBY3RpdmU7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgb3Igbm90IHRhc2sgY2FuIGJlIHNlbnQgdG8gc2VydmVyLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgY2FuUmVzb2x2ZVxuICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgKi9cbiAgQm9tYlRhc2sucHJvdG90eXBlLmNhblJlc29sdmUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdXNlciA9IHRoaXMuJGluamVjdG9yLmdldCgndXNlcicpO1xuICAgIGlmICghdXNlci5pc1VzZXIoKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzTG9ja2VkKCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5yZXNvbHZlZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmR5bmFtaWMpIHtcbiAgICAgIHJldHVybiB0aGlzLnN0b3BwZWQ7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmNvbGxlY3RlZEJveGVzKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldHMgdXAgaW5pdGlhbCBzdGF0ZS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIGluaXRcbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5faW5pdE1lbWJlcnMoKTtcbiAgICB0aGlzLl9pbml0TWF0cml4KCk7XG4gICAgdGhpcy5faW5pdEJvbWIoKTtcblxuICAgIGlmICghdGhpcy5keW5hbWljKSB7XG4gICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBSZXNldHMgaW5pdGlhbCBzdGF0ZS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIHJlc2V0XG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICBCb21iVGFzay5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXQoKTtcbiAgfTtcblxuICAvKipcbiAgICogU2V0cyBgc3RhcnRlZGAgZmxhZy4gSWYgYGR5bmFtaWNgIGlzIHRydWUsXG4gICAqIHRoZSBpbnRlcnZhbCB3aWxsIHN0YXJ0IHRvIHJldmVhbCBjYXJkcy5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIHN0YXJ0XG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICBCb21iVGFzay5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbihpbmRleCkge1xuICAgIGlmICh0aGlzLmR5bmFtaWMpIHtcbiAgICAgIHZhciAkaW50ZXJ2YWwgPSB0aGlzLiRpbmplY3Rvci5nZXQoJyRpbnRlcnZhbCcpO1xuXG4gICAgICB0aGlzLl9pbnRJbmRleCA9IGluZGV4IHx8IDA7XG5cbiAgICAgIHZhciBtZSA9IHRoaXM7XG4gICAgICB2YXIgbWF4ID0gdGhpcy5pdGVyYXRvci5sZW5ndGg7XG4gICAgICB0aGlzLl9pbnRlcnZhbElkID0gJGludGVydmFsKFxuICAgICAgICBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgdmFyIGl0ZW0gPSBtZS5pdGVyYXRvclttZS5faW50SW5kZXhdO1xuICAgICAgICAgIG1lLnVwZGF0ZShpdGVtLHRydWUpO1xuXG4gICAgICAgICAgbWUuX2ludEluZGV4Kys7XG4gICAgICAgICAgaWYgKG1lLl9pbnRJbmRleD09PW1heCkge1xuICAgICAgICAgICAgbWUuc3RvcCgpO1xuICAgICAgICAgIH1cblxuICAgICAgICB9LFxuICAgICAgICB0aGlzLmludGVydmFsKjEwMDAsIC8vID0gZnJvbSBzZWNvbmRzXG4gICAgICAgIG1heCAtIHRoaXMuX2ludEluZGV4IC8vID0gbWF4IGl0ZXJhdGlvbnNcbiAgICAgICk7XG4gICAgfVxuXG4gICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgfTtcblxuICAvKipcbiAgICogU2V0cyBgc3RvcHBlZGAgZmxhZy4gSWYgYGR5bmFtaWNgIGlzIHRydWUsXG4gICAqIHRoZSBpbnRlcnZhbCB3aWxsIGJlIHN0b3BwZWQgaW4gYWRkaXRpb24uXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCBzdGFydFxuICAgKiBAcmV0dXJuIHtWb2lkfVxuICAgKi9cbiAgQm9tYlRhc2sucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5keW5hbWljICYmIHRoaXMuX2ludGVydmFsSWQpIHtcbiAgICAgIHZhciAkaW50ZXJ2YWwgPSB0aGlzLiRpbmplY3Rvci5nZXQoJyRpbnRlcnZhbCcpO1xuICAgICAgJGludGVydmFsLmNhbmNlbCh0aGlzLl9pbnRlcnZhbElkKTtcbiAgICB9XG5cbiAgICB0aGlzLnN0b3BwZWQgPSB0cnVlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXRzIGByZXNvbHZlZGAgZmxhZy4gQ2FsbHMgYG9uUmVzb2x2ZWBcbiAgICogY2FsbGJhY2sgd2l0aCBKU09OIHJlc3VsdCBmb3IgY29uc3VtZXIuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCByZXNvbHZlXG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICBCb21iVGFzay5wcm90b3R5cGUucmVzb2x2ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkcSA9IHRoaXMuJGluamVjdG9yLmdldCgnJHEnKTtcbiAgICB2YXIgcmVzdWx0ID0gdGhpcy5vblJlc29sdmUoe1xuICAgICAgcGF5bG9hZDogdGhpcy5nZXRQYXlsb2FkKClcbiAgICB9KTtcblxuICAgIHZhciByZXNvbHZlQ2FyZCA9IGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgIGNhcmQuJCRyZXNvbHZlZCA9IHRydWU7XG4gICAgfTtcblxuICAgIHZhciBtZSA9IHRoaXM7XG4gICAgdmFyIHN1Y2Nlc3NDYWxsYmFjayA9IGZ1bmN0aW9uKCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKG1lLmNvbGxlY3Rpb24sIHJlc29sdmVDYXJkKTtcbiAgICAgIG1lLnJlc29sdmVkID0gdHJ1ZTtcbiAgICB9O1xuICAgIHZhciBmYWlsdXJlQ2FsbGJhY2sgPSBmdW5jdGlvbigpIHtcblxuICAgIH07XG5cbiAgICB2YXIgcHJvbWlzZSA9ICRxLndoZW4ocmVzdWx0KTtcbiAgICBwcm9taXNlLnRoZW4oXG4gICAgICBzdWNjZXNzQ2FsbGJhY2ssXG4gICAgICBmYWlsdXJlQ2FsbGJhY2tcbiAgICApO1xuXG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH07XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgZmluYWwgdGlja2V0IGFtb3VudCBieSBwcmVkZWZpbmVkIGZvcm11bGEuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICogQG1ldGhvZCBnZXRUaWNrZXRDb3VudFxuICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAqL1xuICBCb21iVGFzay5wcm90b3R5cGUuZ2V0VGlja2V0Q291bnQgPSBmdW5jdGlvbigpe1xuICAgIGlmICh0aGlzLmhhc0JvbWIpIHtcbiAgICAgIHJldHVybiAxO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNvbGxlY3RlZEJveGVzICsgMTtcbiAgfTtcblxuICAvKipcbiAgICogQ2FsbGJhY2sgZm9yIGNhcmQgY2xpY2suIFVwZGF0ZXMgYWxsXG4gICAqIHJlbGF0ZWQgcHJvcGVydGllcyBmb3IgZmluYWwgcmVzdWx0LlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgdG9nZ2xlXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBjb2x1bW5cbiAgICogQHBhcmFtIHtib29sZWFufSBhY3RpdmVcbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbihjb2x1bW4sIGFjdGl2ZSkge1xuICAgIHZhciBpbmRleCA9IHRoaXMuY29sbGVjdGlvbi5pbmRleE9mKGNvbHVtbik7XG5cbiAgICBpZiAoYWN0aXZlKSB7XG4gICAgICBpZiAoaW5kZXg8MCnCoHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLnB1c2goY29sdW1uKTtcbiAgICAgICAgdGhpcy5jb2xsZWN0ZWRCb3hlcysrO1xuICAgICAgfVxuXG4gICAgICBjb2x1bW4uJCRhY3RpdmUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoaW5kZXg+PTApIHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLnNwbGljZShpbmRleCwxKTtcbiAgICAgICAgY29sdW1uLiQkYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29sbGVjdGVkQm94ZXMtLTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0JvbWIoY29sdW1uKSkge1xuICAgICAgdGhpcy5oYXNCb21iID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgdG90YWwgPSB0aGlzLnRvdGFsQm94ZXM7XG4gICAgdmFyIGNvbGxlY3RlZCA9IHRoaXMuY29sbGVjdGVkQm94ZXM7XG4gICAgdGhpcy5yZW1haW5pbmdCb3hlcyA9IHRvdGFsIC0gY29sbGVjdGVkO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQcm92aWRlcyBpbmRpdml1YWwgdHJhY2tpbmcgaWQgZm9yIGNvbHVtbi5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIHRyYWNrSWRcbiAgICogQHBhcmFtIHtvYmplY3R9IGNvbHVtblxuICAgKiBAcmV0dXJuIHtWb2lkfVxuICAgKi9cbiAgQm9tYlRhc2sucHJvdG90eXBlLnRyYWNrSWQgPSBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICByZXR1cm4gY29sdW1uLnJvdyArICdfJyArIGNvbHVtbi5jb2w7XG4gIH07XG5cbiAgLyoqXG4gICAqIERldGVybWluZXMgaWYgY29sdW1uIGlzIGFjdHVhbCBib21iLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2QgaXNCb21iXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBjb2x1bW5cbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS5pc0JvbWIgPSBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICByZXR1cm4gYW5ndWxhci5lcXVhbHModGhpcy5ib21iLGNvbHVtbik7XG4gIH07XG5cbiAgLyoqXG4gICAqIEluaXRpYWx6ZXMgaW50ZXJuYWwgcHJvcGVydGllcy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQG1ldGhvZCBfaW5pdE1lbWJlcnNcbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS5faW5pdE1lbWJlcnMgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNvbGxlY3Rpb24gPSBbXTtcblxuICAgIHRoaXMuaGFzQm9tYiA9IGZhbHNlO1xuICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgIHRoaXMuc3RvcHBlZCA9IGZhbHNlO1xuICAgIHRoaXMucmVzb2x2ZWQgPSBmYWxzZTtcblxuICAgIHRoaXMuY29sbGVjdGVkQm94ZXMgPSAwO1xuICAgIHRoaXMucmVtYWluaW5nQm94ZXMgPSAwO1xuICAgIHRoaXMudG90YWxCb3hlcyA9IHRoaXMucm93cyAqIHRoaXMuY29scztcbiAgfTtcblxuICAvKipcbiAgICogQ2FsY3VsYXRlcyB0aGUgYWN0dWFsIG1hdHJpeC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQG1ldGhvZCBfaW5pdE1hdHJpeFxuICAgKiBAcmV0dXJuIHtWb2lkfVxuICAgKi9cbiAgQm9tYlRhc2sucHJvdG90eXBlLl9pbml0TWF0cml4ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5tYXRyaXggPSBbXTtcbiAgICB0aGlzLml0ZXJhdG9yID0gW107XG5cbiAgICBmb3IgKHZhciBpPTA7IGk8dGhpcy5yb3dzOyBpKyspIHtcblxuICAgICAgdmFyIGNvbHVtbnMgPSBbXTtcbiAgICAgIGZvciggdmFyIGo9MDsgajx0aGlzLmNvbHM7IGorKyApIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgcm93OiBpKzEsXG4gICAgICAgICAgY29sOiBqKzFcbiAgICAgICAgfTtcblxuICAgICAgICBjb2x1bW5zLnB1c2goZGF0YSk7XG5cbiAgICAgICAgaWYgKHRoaXMuZHluYW1pYykge1xuICAgICAgICAgIGlmICghdGhpcy5yYW5kb20pIHtcbiAgICAgICAgICAgIHRoaXMuaXRlcmF0b3IucHVzaChkYXRhKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHJhbmRvbSA9IHRoaXMuJGluamVjdG9yLmdldCgncmFuZG9tJyk7XG4gICAgICAgICAgICByYW5kb20ucHVzaCh0aGlzLml0ZXJhdG9yLGRhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLm1hdHJpeC5wdXNoKGNvbHVtbnMpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgYm9tYidzIGFjdHVhbCBsb2NhdGlvbi5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQG1ldGhvZCBfaW5pdEJvbWJcbiAgICogQHJldHVybiB7Vm9pZH1cbiAgICovXG4gIEJvbWJUYXNrLnByb3RvdHlwZS5faW5pdEJvbWIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgcmFuZG9tID0gdGhpcy4kaW5qZWN0b3IuZ2V0KCdyYW5kb20nKTtcblxuICAgIHZhciByb3cgPSByYW5kb20uYmV0d2VlbigwLHRoaXMucm93cy0xKTtcbiAgICB2YXIgY29sID0gcmFuZG9tLmJldHdlZW4oMCx0aGlzLmNvbHMtMSk7XG5cbiAgICB0aGlzLmJvbWIgPSB0aGlzLm1hdHJpeFtyb3ddW2NvbF07XG4gIH07XG5cbiAgLy9cbiAgLy8gUkVHSVNUUllcbiAgLy9cbiAgYW5ndWxhci5tb2R1bGUobW9kdWxlKS5kaXJlY3RpdmUoJ2JvbWJUYXNrJyxmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICBzY29wZToge1xuICAgICAgICBhdmc6ICc9P2JvbWJUYXNrQXZnJyxcbiAgICAgICAgcm93czogJz0/Ym9tYlRhc2tSb3dzJyxcbiAgICAgICAgY29sczogJz0/Ym9tYlRhc2tDb2xzJyxcbiAgICAgICAgcmFuZG9tOiAnPT9ib21iVGFza1JhbmRvbScsXG4gICAgICAgIGR5bmFtaWM6ICc9P2JvbWJUYXNrRHluYW1pYycsXG4gICAgICAgIGludGVydmFsOiAnPT9ib21iVGFza0ludGVydmFsJyxcbiAgICAgICAgb25SZXNvbHZlOiAnJmJvbWJUYXNrT25SZXNvbHZlJ1xuICAgICAgfSxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogQm9tYlRhc2ssXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgY29udHJvbGxlckFzOiAnYm9tYlRhc2tDb250cm9sbGVyJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvZGlyZWN0aXZlcy90YXNrcy9ib21iLXRhc2suaHRtbCdcbiAgICB9O1xuICB9KTtcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBCb21iVGFzayBDYXJkXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy9cbiAgLy8gQ09OVFJPTExFUlxuICAvL1xuXG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIHZhciBCb21iVGFza0NhcmQgPSBmdW5jdGlvbigpe1xuICB9O1xuXG4gIC8vXG4gIC8vIFBST1BFUlRJRVNcbiAgLy9cblxuICAvKiogQHZhciB7c3RyaW5nfSBpZCBDYXJkJ3MgYWNjb2NpYXRlZCBtb2RlbC4gKi9cbiAgQm9tYlRhc2tDYXJkLnByb3RvdHlwZS5tb2RlbCA9IG51bGw7XG5cbiAgLyoqIEB2YXIge3N0cmluZ30gaXNBY3RpdmUgSWYgY2FyZCBpcyBhY3RpdmUuICovXG4gIEJvbWJUYXNrQ2FyZC5wcm90b3R5cGUuaXNBY3RpdmUgPSBmYWxzZTtcblxuICAvKiogQHZhciB7c3RyaW5nfSBpc0Rpc2FibGVkIElmIGNhcmQgaXMgZGlzYWJsZWQuICovXG4gIEJvbWJUYXNrQ2FyZC5wcm90b3R5cGUuaXNEaXNhYmxlZCA9IGZhbHNlO1xuXG4gIC8qKiBAdmFyIHtzdHJpbmd9IGlzQ2xpY2thYmxlIElmIGNhcmQgaXMgY2xpY2thYmxlLiAqL1xuICBCb21iVGFza0NhcmQucHJvdG90eXBlLmlzQ2xpY2thYmxlID0gdHJ1ZTtcblxuICAvL1xuICAvLyBNRVRIT0RTXG4gIC8vXG5cbiAgLyoqXG4gICAqIFRvZ2dsZXMgYGlzQWN0aXZlYCBpZiBgaXNEaXNhYmxlZGAgYW5kXG4gICAqIGBpc0NsaWNrYWJsZWAgYWxsb3cgdGhlIGFjdGlvbi4gSW52b2tlc1xuICAgKiBgb25Ub2dnbGVgIGNhbGxiYWNrIGZvciBjb25zdW1lci5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kIHRvZ2dsZVxuICAgKiBAcmV0dXJuIHtWb2lkfVxuICAgKi9cbiAgQm9tYlRhc2tDYXJkLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5pc0Rpc2FibGVkIHx8ICF0aGlzLmlzQ2xpY2thYmxlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pc0FjdGl2ZSA9ICF0aGlzLmlzQWN0aXZlO1xuXG4gICAgdGhpcy5vblRvZ2dsZSh7XG4gICAgICBtb2RlbDp0aGlzLm1vZGVsLFxuICAgICAgc3RhdGU6dGhpcy5pc0FjdGl2ZVxuICAgIH0pO1xuICB9O1xuXG4gIC8vIHJlZ2lzdHJ5XG4gIGFuZ3VsYXIubW9kdWxlKG1vZHVsZSkuZGlyZWN0aXZlKCdib21iVGFza0NhcmQnLCBmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICBzY29wZToge1xuICAgICAgICBtb2RlbDonPWJvbWJUYXNrQ2FyZCcsXG4gICAgICAgIG9uVG9nZ2xlOicmYm9tYlRhc2tDYXJkT25Ub2dnbGUnLFxuICAgICAgICBpc0FjdGl2ZTonPT9ib21iVGFza0NhcmRJc0FjdGl2ZScsXG4gICAgICAgIGlzRGlzYWJsZWQ6Jz0/Ym9tYlRhc2tDYXJkSXNEaXNhYmxlZCcsXG4gICAgICAgIGlzQ2xpY2thYmxlOic9P2JvbWJUYXNrQ2FyZElzQ2xpY2thYmxlJ1xuICAgICAgfSxcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgY29udHJvbGxlcjogQm9tYlRhc2tDYXJkLFxuICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXJBczogJ2JvbWJUYXNrQ2FyZENvbnRyb2xsZXInLFxuICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9kaXJlY3RpdmVzL3Rhc2tzL2JvbWItdGFzay1jYXJkLmh0bWwnXG4gICAgfTtcbiAgfSk7XG5cbn0pKEFOR1VMQVJfTU9EVUxFLCBhbmd1bGFyKTtcbiJdfQ==
